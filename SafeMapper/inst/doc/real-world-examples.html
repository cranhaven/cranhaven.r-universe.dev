<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Real-World Examples</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Real-World Examples</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This guide presents real-world scenarios where SafeMapper shines.
Each example includes complete code, configuration recommendations, and
best practices.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span></code></pre></div>
</div>
<div id="example-1-web-api-data-collection" class="section level2">
<h2>Example 1: Web API Data Collection</h2>
<div id="scenario" class="section level3">
<h3>Scenario</h3>
<p>You need to collect data from a REST API for 10,000 records. Each API
call takes ~500ms, and the API occasionally returns errors or times
out.</p>
<pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                    API Data Collection Challenge                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Requirements:                                                              │
│   ├── 10,000 API calls needed                                               │
│   ├── ~500ms per call = ~83 minutes total                                   │
│   ├── API has rate limit: 100 calls/minute                                  │
│   ├── ~5% of calls fail (timeout, server error)                            │
│   └── Cannot lose progress on failure                                       │
│                                                                              │
│   Without SafeMapper:                                                        │
│   ├── Crash at call 8,000 = Start over (67 min lost)                       │
│   ├── Must manually implement retry logic                                   │
│   └── Must manually implement checkpointing                                 │
│                                                                              │
│   With SafeMapper:                                                           │
│   ├── Crash at call 8,000 = Resume from 8,000                              │
│   ├── Built-in retry for transient failures                                │
│   └── Automatic checkpointing every batch                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
<div id="implementation" class="section level3">
<h3>Implementation</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Simulated API function (replace with real API call)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>fetch_api_data <span class="ot">&lt;-</span> <span class="cf">function</span>(id) {</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="co"># Simulate API latency</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.01</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="co"># Simulate occasional failures (5% rate)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;API Error: Connection timeout&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  }</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="co"># Return simulated data</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="at">id =</span> id,</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>),</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">Sys.time</span>()</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  )</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>}</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co"># Configure for API workload</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">20</span>,      <span class="co"># Save every 20 calls (~10 seconds of work)</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">3</span>    <span class="co"># Retry failed calls up to 3 times</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co"># Wrap with error handling for graceful failure</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>safe_fetch <span class="ot">&lt;-</span> <span class="fu">s_possibly</span>(fetch_api_data, <span class="at">otherwise =</span> <span class="cn">NULL</span>)</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co"># Collect data with fault tolerance</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>  <span class="co"># In production: 1:10000</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>  ids,</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>  safe_fetch,</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;api_collection_2026&quot;</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>)</span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; [1%] Processing items 1-20 of 100</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt; [21%] Processing items 21-40 of 100</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt; [41%] Processing items 41-60 of 100</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt; [61%] Processing items 61-80 of 100</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt; [81%] Processing items 81-100 of 100</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt; Completed 100 items</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co"># Process results</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>successful <span class="ot">&lt;-</span> results[<span class="sc">!</span><span class="fu">sapply</span>(results, is.null)]</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Successfully collected:&quot;</span>, <span class="fu">length</span>(successful), <span class="st">&quot;records</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co">#&gt; Successfully collected: 98 records</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Failed:&quot;</span>, <span class="fu">sum</span>(<span class="fu">sapply</span>(results, is.null)), <span class="st">&quot;records</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="co">#&gt; Failed: 2 records</span></span></code></pre></div>
</div>
<div id="convert-to-data-frame" class="section level3">
<h3>Convert to Data Frame</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Convert successful results to data frame</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(successful) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(successful, <span class="cf">function</span>(x) {</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>      <span class="at">id =</span> x<span class="sc">$</span>id,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>      <span class="at">value =</span> x<span class="sc">$</span>value,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>      <span class="at">timestamp =</span> <span class="fu">as.character</span>(x<span class="sc">$</span>timestamp)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    )</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  }))</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(df))</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;   id       value                  timestamp</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 1  1 -0.27384681 2026-01-27 18:25:32.683616</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; 2  2 -0.58483342 2026-01-27 18:25:32.697349</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 3  3  0.93306103 2026-01-27 18:25:32.709916</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; 4  4 -0.62604690 2026-01-27 18:25:32.720831</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 5  5 -0.07996057 2026-01-27 18:25:32.731632</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; 6  6 -1.59823103 2026-01-27 18:25:32.744194</span></span></code></pre></div>
</div>
</div>
<div id="example-2-batch-file-processing" class="section level2">
<h2>Example 2: Batch File Processing</h2>
<div id="scenario-1" class="section level3">
<h3>Scenario</h3>
<p>Process 1,000 large CSV files, each requiring ~30 seconds of
computation.</p>
<pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                    Batch File Processing                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Pipeline:                                                                  │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐                 │
│   │  Read   │───►│  Clean  │───►│ Process │───►│  Save   │                 │
│   │  File   │    │  Data   │    │  Data   │    │ Result  │                 │
│   └─────────┘    └─────────┘    └─────────┘    └─────────┘                 │
│                                                                              │
│   Challenges:                                                                │
│   ├── Some files may be corrupted                                          │
│   ├── Memory constraints (can&#39;t load all at once)                          │
│   ├── ~8 hours total runtime                                               │
│   └── System might restart overnight                                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
<div id="implementation-1" class="section level3">
<h3>Implementation</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Simulated file processing function</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>process_file <span class="ot">&lt;-</span> <span class="cf">function</span>(file_info) {</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="co"># Simulate file processing</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.01</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="co"># Simulate occasional corrupt files</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.02</span>) {</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Corrupt file: &quot;</span>, file_info<span class="sc">$</span>name)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  }</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="co"># Return processed result</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    <span class="at">file =</span> file_info<span class="sc">$</span>name,</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>    <span class="at">rows_processed =</span> <span class="fu">sample</span>(<span class="dv">1000</span><span class="sc">:</span><span class="dv">5000</span>, <span class="dv">1</span>),</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    <span class="at">processing_time =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">40</span>)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  )</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>}</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co"># Create sample file list</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) {</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">paste0</span>(<span class="st">&quot;data_&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%04d&quot;</span>, i), <span class="st">&quot;.csv&quot;</span>),</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>    <span class="at">path =</span> <span class="fu">paste0</span>(<span class="st">&quot;/data/raw/data_&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%04d&quot;</span>, i), <span class="st">&quot;.csv&quot;</span>),</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>    <span class="at">size_mb =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  )</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>})</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co"># Configure for file processing</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">10</span>,      <span class="co"># Checkpoint every 10 files</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">2</span>    <span class="co"># Limited retries (corrupt files won&#39;t fix themselves)</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>)</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co"># Process with error capture</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>safe_process <span class="ot">&lt;-</span> <span class="fu">s_safely</span>(process_file)</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>  files,</span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>  safe_process,</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;file_batch_2026_01&quot;</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>)</span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt; [2%] Processing items 1-10 of 50</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt; [22%] Processing items 11-20 of 50</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt; [42%] Processing items 21-30 of 50</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#&gt; [62%] Processing items 31-40 of 50</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co">#&gt; [82%] Processing items 41-50 of 50</span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a><span class="co">#&gt; Completed 50 items</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co"># Summarize results</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a>successes <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(results, <span class="cf">function</span>(x) <span class="fu">is.null</span>(x<span class="sc">$</span>error)))</span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a>failures <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(results, <span class="cf">function</span>(x) <span class="sc">!</span><span class="fu">is.null</span>(x<span class="sc">$</span>error)))</span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Processed:&quot;</span>, successes, <span class="st">&quot;files</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a><span class="co">#&gt; Processed: 48 files</span></span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Failed:&quot;</span>, failures, <span class="st">&quot;files</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a><span class="co">#&gt; Failed: 2 files</span></span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a></span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a><span class="co"># Get failure details</span></span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a>failed_files <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results, <span class="cf">function</span>(x) {</span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(x<span class="sc">$</span>error)) x<span class="sc">$</span>error<span class="sc">$</span>message <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a>})</span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a>failed_files <span class="ot">&lt;-</span> failed_files[<span class="sc">!</span><span class="fu">is.na</span>(failed_files)]</span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(failed_files) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb6-64"><a href="#cb6-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Failure reasons:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-65"><a href="#cb6-65" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(failed_files))</span>
<span id="cb6-66"><a href="#cb6-66" tabindex="-1"></a>}</span>
<span id="cb6-67"><a href="#cb6-67" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-68"><a href="#cb6-68" tabindex="-1"></a><span class="co">#&gt; Failure reasons:</span></span>
<span id="cb6-69"><a href="#cb6-69" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Corrupt file: data_0004.csv&quot; &quot;Corrupt file: data_0040.csv&quot;</span></span></code></pre></div>
</div>
</div>
<div id="example-3-machine-learning-cross-validation" class="section level2">
<h2>Example 3: Machine Learning Cross-Validation</h2>
<div id="scenario-2" class="section level3">
<h3>Scenario</h3>
<p>Run 5-fold cross-validation with 100 hyperparameter combinations.
Each model takes ~2 minutes to train.</p>
<pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                    Cross-Validation Grid Search                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Grid:                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  Hyperparameters × Folds = Total Models                             │   │
│   │       100        ×   5   =   500 models                             │   │
│   │                                                                     │   │
│   │  Time estimate: 500 × 2 min = ~17 hours                            │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│   Strategy with SafeMapper:                                                  │
│   ├── Checkpoint every 5 models (~10 min of work)                          │
│   ├── Use parallel processing for CPU-bound training                       │
│   └── Resume automatically if interrupted                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
<div id="implementation-2" class="section level3">
<h3>Implementation</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Create parameter grid</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">learning_rate =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">fold =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># Simulated model training function</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>train_model <span class="ot">&lt;-</span> <span class="cf">function</span>(params) {</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="co"># Simulate training time</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.01</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="co"># Simulate model performance (depends on hyperparameters)</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  base_score <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  lr_bonus <span class="ot">&lt;-</span> (<span class="fl">0.1</span> <span class="sc">-</span> params<span class="sc">$</span>learning_rate) <span class="sc">*</span> <span class="fl">0.5</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>  depth_bonus <span class="ot">&lt;-</span> params<span class="sc">$</span>max_depth <span class="sc">*</span> <span class="fl">0.01</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>  noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.05</span>)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  </span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>    <span class="at">learning_rate =</span> params<span class="sc">$</span>learning_rate,</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>    <span class="at">max_depth =</span> params<span class="sc">$</span>max_depth,</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>    <span class="at">fold =</span> params<span class="sc">$</span>fold,</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">min</span>(<span class="dv">1</span>, <span class="fu">max</span>(<span class="dv">0</span>, base_score <span class="sc">+</span> lr_bonus <span class="sc">+</span> depth_bonus <span class="sc">+</span> noise)),</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>    <span class="at">training_time =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">140</span>)</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  )</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>}</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co"># Configure for ML workload</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">5</span>,       <span class="co"># Checkpoint every 5 models</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">2</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>)</span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co"># Convert grid to list for mapping</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a>param_list <span class="ot">&lt;-</span> <span class="fu">split</span>(param_grid, <span class="fu">seq_len</span>(<span class="fu">nrow</span>(param_grid)))</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co"># Train all models with checkpointing</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a>  param_list,</span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a>  train_model,</span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;cv_grid_search_v1&quot;</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a>)</span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt; [4%] Processing items 1-5 of 27</span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt; [22%] Processing items 6-10 of 27</span></span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a><span class="co">#&gt; [41%] Processing items 11-15 of 27</span></span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a><span class="co">#&gt; [59%] Processing items 16-20 of 27</span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co">#&gt; [78%] Processing items 21-25 of 27</span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a><span class="co">#&gt; [96%] Processing items 26-27 of 27</span></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a><span class="co">#&gt; Completed 27 items</span></span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co"># Aggregate results</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(results, as.data.frame))</span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a></span>
<span id="cb8-54"><a href="#cb8-54" tabindex="-1"></a><span class="co"># Find best hyperparameters (average across folds)</span></span>
<span id="cb8-55"><a href="#cb8-55" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(</span>
<span id="cb8-56"><a href="#cb8-56" tabindex="-1"></a>  accuracy <span class="sc">~</span> learning_rate <span class="sc">+</span> max_depth,</span>
<span id="cb8-57"><a href="#cb8-57" tabindex="-1"></a>  <span class="at">data =</span> results_df,</span>
<span id="cb8-58"><a href="#cb8-58" tabindex="-1"></a>  <span class="at">FUN =</span> mean</span>
<span id="cb8-59"><a href="#cb8-59" tabindex="-1"></a>)</span>
<span id="cb8-60"><a href="#cb8-60" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> best_params[<span class="fu">order</span>(<span class="sc">-</span>best_params<span class="sc">$</span>accuracy), ]</span>
<span id="cb8-61"><a href="#cb8-61" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Best hyperparameters:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-62"><a href="#cb8-62" tabindex="-1"></a><span class="co">#&gt; Best hyperparameters:</span></span>
<span id="cb8-63"><a href="#cb8-63" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(best_params, <span class="dv">3</span>))</span>
<span id="cb8-64"><a href="#cb8-64" tabindex="-1"></a><span class="co">#&gt;   learning_rate max_depth  accuracy</span></span>
<span id="cb8-65"><a href="#cb8-65" tabindex="-1"></a><span class="co">#&gt; 5          0.05         5 0.8289758</span></span>
<span id="cb8-66"><a href="#cb8-66" tabindex="-1"></a><span class="co">#&gt; 1          0.01         3 0.8009079</span></span>
<span id="cb8-67"><a href="#cb8-67" tabindex="-1"></a><span class="co">#&gt; 4          0.01         5 0.7988678</span></span></code></pre></div>
</div>
</div>
<div id="example-4-web-scraping-pipeline" class="section level2">
<h2>Example 4: Web Scraping Pipeline</h2>
<div id="scenario-3" class="section level3">
<h3>Scenario</h3>
<p>Scrape product information from 5,000 web pages with rate
limiting.</p>
<pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                    Web Scraping Pipeline                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Workflow:                                                                  │
│                                                                              │
│   URLs ──► Fetch HTML ──► Parse Data ──► Validate ──► Store                │
│                │              │              │                               │
│                ▼              ▼              ▼                               │
│           [May fail]    [May fail]    [May fail]                            │
│                                                                              │
│   Error Handling Strategy:                                                   │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  Level 1: s_possibly for individual page failures                   │   │
│   │  Level 2: SafeMapper retry for batch failures                       │   │
│   │  Level 3: Checkpointing for session recovery                        │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
<div id="implementation-3" class="section level3">
<h3>Implementation</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Simulated scraping function</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>scrape_page <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="co"># Rate limiting (be respectful!)</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.02</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="co"># Simulate various failure modes</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  rand <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="fl">0.03</span>) <span class="fu">stop</span>(<span class="st">&quot;HTTP 404: Page not found&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="fu">stop</span>(<span class="st">&quot;HTTP 503: Service unavailable&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="fl">0.07</span>) <span class="fu">stop</span>(<span class="st">&quot;Parsing error: Invalid HTML&quot;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  </span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  <span class="co"># Return scraped data</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>    <span class="at">url =</span> url,</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Product&quot;</span>, <span class="fu">sample</span>(<span class="dv">1000</span><span class="sc">:</span><span class="dv">9999</span>, <span class="dv">1</span>)),</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>    <span class="at">price =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">500</span>), <span class="dv">2</span>),</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    <span class="at">rating =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>), <span class="dv">1</span>),</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>    <span class="at">scraped_at =</span> <span class="fu">Sys.time</span>()</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  )</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>}</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co"># Create URL list</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;https://example.com/product/&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co"># Configure for scraping</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">25</span>,      <span class="co"># Checkpoint every 25 pages</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">3</span>    <span class="co"># Retry for transient errors</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>)</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co"># Multi-layer error handling</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>robust_scrape <span class="ot">&lt;-</span> <span class="fu">s_possibly</span>(scrape_page, <span class="at">otherwise =</span> <span class="cn">NULL</span>)</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co"># Scrape with fault tolerance</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>scraped_data <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a>  urls,</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>  robust_scrape,</span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;product_scrape_2026_01&quot;</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>)</span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="co">#&gt; [1%] Processing items 1-25 of 100</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a><span class="co">#&gt; [26%] Processing items 26-50 of 100</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a><span class="co">#&gt; [51%] Processing items 51-75 of 100</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a><span class="co">#&gt; [76%] Processing items 76-100 of 100</span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="co">#&gt; Completed 100 items</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a><span class="co"># Analyze results</span></span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a>successful <span class="ot">&lt;-</span> scraped_data[<span class="sc">!</span><span class="fu">sapply</span>(scraped_data, is.null)]</span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a>failed_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(scraped_data, is.null))</span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Successfully scraped:&quot;</span>, <span class="fu">length</span>(successful), <span class="st">&quot;pages</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a><span class="co">#&gt; Successfully scraped: 92 pages</span></span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Failed:&quot;</span>, failed_count, <span class="st">&quot;pages</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a><span class="co">#&gt; Failed: 8 pages</span></span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a><span class="co"># Convert to data frame</span></span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(successful) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a>  products_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(successful, <span class="cf">function</span>(x) {</span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a>      <span class="at">url =</span> x<span class="sc">$</span>url,</span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a>      <span class="at">title =</span> x<span class="sc">$</span>title,</span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a>      <span class="at">price =</span> x<span class="sc">$</span>price,</span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a>      <span class="at">rating =</span> x<span class="sc">$</span>rating,</span>
<span id="cb10-63"><a href="#cb10-63" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb10-64"><a href="#cb10-64" tabindex="-1"></a>    )</span>
<span id="cb10-65"><a href="#cb10-65" tabindex="-1"></a>  }))</span>
<span id="cb10-66"><a href="#cb10-66" tabindex="-1"></a>  </span>
<span id="cb10-67"><a href="#cb10-67" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Sample products:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-68"><a href="#cb10-68" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(products_df))</span>
<span id="cb10-69"><a href="#cb10-69" tabindex="-1"></a>  </span>
<span id="cb10-70"><a href="#cb10-70" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Price statistics:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-71"><a href="#cb10-71" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(products_df<span class="sc">$</span>price))</span>
<span id="cb10-72"><a href="#cb10-72" tabindex="-1"></a>}</span>
<span id="cb10-73"><a href="#cb10-73" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-74"><a href="#cb10-74" tabindex="-1"></a><span class="co">#&gt; Sample products:</span></span>
<span id="cb10-75"><a href="#cb10-75" tabindex="-1"></a><span class="co">#&gt;                             url        title  price rating</span></span>
<span id="cb10-76"><a href="#cb10-76" tabindex="-1"></a><span class="co">#&gt; 1 https://example.com/product/1 Product 4810 473.36    4.5</span></span>
<span id="cb10-77"><a href="#cb10-77" tabindex="-1"></a><span class="co">#&gt; 2 https://example.com/product/2 Product 9690 391.50    4.0</span></span>
<span id="cb10-78"><a href="#cb10-78" tabindex="-1"></a><span class="co">#&gt; 3 https://example.com/product/3 Product 8930 488.26    1.4</span></span>
<span id="cb10-79"><a href="#cb10-79" tabindex="-1"></a><span class="co">#&gt; 4 https://example.com/product/4 Product 3453 134.83    3.8</span></span>
<span id="cb10-80"><a href="#cb10-80" tabindex="-1"></a><span class="co">#&gt; 5 https://example.com/product/5 Product 8968  38.14    1.5</span></span>
<span id="cb10-81"><a href="#cb10-81" tabindex="-1"></a><span class="co">#&gt; 6 https://example.com/product/6 Product 5017 317.27    1.0</span></span>
<span id="cb10-82"><a href="#cb10-82" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-83"><a href="#cb10-83" tabindex="-1"></a><span class="co">#&gt; Price statistics:</span></span>
<span id="cb10-84"><a href="#cb10-84" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb10-85"><a href="#cb10-85" tabindex="-1"></a><span class="co">#&gt;   15.01  150.99  315.06  289.56  432.45  493.85</span></span></code></pre></div>
</div>
</div>
<div id="example-5-parallel-bioinformatics-pipeline" class="section level2">
<h2>Example 5: Parallel Bioinformatics Pipeline</h2>
<div id="scenario-4" class="section level3">
<h3>Scenario</h3>
<p>Process 500 genomic sequences using parallel computation.</p>
<pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                    Bioinformatics Pipeline                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Processing Steps per Sequence:                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  1. Quality Control (5 sec)                                         │   │
│   │  2. Alignment (30 sec)                                              │   │
│   │  3. Variant Calling (20 sec)                                        │   │
│   │  4. Annotation (10 sec)                                             │   │
│   │  Total: ~65 sec per sequence                                        │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│   Sequential: 500 × 65s = ~9 hours                                          │
│   Parallel (4 cores): ~2.5 hours                                            │
│   With SafeMapper: Resume if interrupted + parallel speedup                  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
<div id="implementation-4" class="section level3">
<h3>Implementation</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># Set up parallel processing</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">4</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># Simulated genomics processing</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>process_sequence <span class="ot">&lt;-</span> <span class="cf">function</span>(seq_info) {</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="co"># QC</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.05</span>)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  qc_pass <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&gt;</span> <span class="fl">0.1</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>qc_pass) {</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>      <span class="at">id =</span> seq_info<span class="sc">$</span>id,</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>      <span class="at">status =</span> <span class="st">&quot;failed_qc&quot;</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>      <span class="at">variants =</span> <span class="cn">NULL</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>    ))</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  }</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  </span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="co"># Alignment + Variant calling + Annotation</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.1</span>)</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  </span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>    <span class="at">id =</span> seq_info<span class="sc">$</span>id,</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>    <span class="at">status =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>    <span class="at">variants =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">50</span>, <span class="dv">1</span>),</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>    <span class="at">quality_score =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">40</span>)</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>  )</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>}</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co"># Create sequence list</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>sequences <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="cf">function</span>(i) {</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">&quot;SEQ_&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%05d&quot;</span>, i)),</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>    <span class="at">length =</span> <span class="fu">sample</span>(<span class="dv">1000</span><span class="sc">:</span><span class="dv">5000</span>, <span class="dv">1</span>)</span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>  )</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>})</span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co"># Configure for bioinformatics</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">20</span>,      <span class="co"># Balance checkpoint frequency and parallel efficiency</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">2</span></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a>)</span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a><span class="co"># Process with parallel + fault tolerance</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_future_map</span>(</span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>  sequences,</span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>  process_sequence,</span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;genomics_batch_001&quot;</span>,</span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a>  <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a>)</span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a><span class="co"># Clean up parallel backend</span></span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a><span class="co"># Summarize</span></span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a>status_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">sapply</span>(results, <span class="cf">function</span>(x) x<span class="sc">$</span>status))</span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a><span class="fu">print</span>(status_counts)</span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a></span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a><span class="co"># Get variant statistics for successful samples</span></span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a>successful <span class="ot">&lt;-</span> results[<span class="fu">sapply</span>(results, <span class="cf">function</span>(x) x<span class="sc">$</span>status <span class="sc">==</span> <span class="st">&quot;success&quot;</span>)]</span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a>variants <span class="ot">&lt;-</span> <span class="fu">sapply</span>(successful, <span class="cf">function</span>(x) x<span class="sc">$</span>variants)</span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Variant count summary:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(variants))</span></code></pre></div>
</div>
</div>
<div id="example-6-database-migration" class="section level2">
<h2>Example 6: Database Migration</h2>
<div id="scenario-5" class="section level3">
<h3>Scenario</h3>
<p>Migrate 100,000 records from one database to another with
transformation.</p>
<pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                    Database Migration                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Pipeline:                                                                  │
│   ┌──────────────┐    ┌──────────────┐    ┌──────────────┐                 │
│   │   Source DB  │───►│  Transform   │───►│   Target DB  │                 │
│   │   (Read)     │    │  (Process)   │    │   (Write)    │                 │
│   └──────────────┘    └──────────────┘    └──────────────┘                 │
│                                                                              │
│   Requirements:                                                              │
│   ├── Process in batches to avoid memory issues                            │
│   ├── Track exactly which records were migrated                            │
│   ├── Resume from failure without duplicates                               │
│   └── Generate migration report                                             │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
<div id="implementation-5" class="section level3">
<h3>Implementation</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Simulated migration function</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>migrate_record <span class="ot">&lt;-</span> <span class="cf">function</span>(record) {</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="co"># Simulate read from source</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.005</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="co"># Simulate occasional failures</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.02</span>) {</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Database connection error&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  }</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  </span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="co"># Transform</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  transformed <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>    <span class="at">id =</span> record<span class="sc">$</span>id,</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>    <span class="at">new_field =</span> <span class="fu">paste</span>(record<span class="sc">$</span>name, record<span class="sc">$</span>category, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>    <span class="at">migrated_at =</span> <span class="fu">Sys.time</span>(),</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>    <span class="at">source_hash =</span> digest<span class="sc">::</span><span class="fu">digest</span>(record)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>  )</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  </span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>  <span class="co"># Simulate write to target</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.005</span>)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  </span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>    <span class="at">original_id =</span> record<span class="sc">$</span>id,</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>    <span class="at">new_id =</span> transformed<span class="sc">$</span>id,</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>    <span class="at">status =</span> <span class="st">&quot;migrated&quot;</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>  )</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>}</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co"># Create sample records</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>records <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="cf">function</span>(i) {</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>    <span class="at">id =</span> i,</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">paste0</span>(<span class="st">&quot;Record_&quot;</span>, i),</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>    <span class="at">category =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dv">1</span>),</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a>  )</span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a>})</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co"># Configure for database operations</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">50</span>,      <span class="co"># Reasonable transaction size</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">5</span>    <span class="co"># Database errors often transient</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a>)</span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co"># Migrate with fault tolerance</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a>safe_migrate <span class="ot">&lt;-</span> <span class="fu">s_safely</span>(migrate_record)</span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a>migration_results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a>  records,</span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a>  safe_migrate,</span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;db_migration_v1&quot;</span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a>)</span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co">#&gt; [0%] Processing items 1-50 of 200</span></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a><span class="co">#&gt; [26%] Processing items 51-100 of 200</span></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a><span class="co">#&gt; [50%] Processing items 101-150 of 200</span></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a><span class="co">#&gt; [76%] Processing items 151-200 of 200</span></span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a><span class="co">#&gt; Completed 200 items</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a></span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a><span class="co"># Generate migration report</span></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a>successful <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(migration_results, <span class="cf">function</span>(x) <span class="fu">is.null</span>(x<span class="sc">$</span>error)))</span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a>failed <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(migration_results, <span class="cf">function</span>(x) <span class="sc">!</span><span class="fu">is.null</span>(x<span class="sc">$</span>error)))</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Migration Report</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a><span class="co">#&gt; Migration Report</span></span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;================</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a><span class="co">#&gt; ================</span></span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Total records:&quot;</span>, <span class="fu">length</span>(records), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a><span class="co">#&gt; Total records: 200</span></span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Migrated:&quot;</span>, successful, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a><span class="co">#&gt; Migrated: 198</span></span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Failed:&quot;</span>, failed, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a><span class="co">#&gt; Failed: 2</span></span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Success rate:&quot;</span>, <span class="fu">round</span>(successful <span class="sc">/</span> <span class="fu">length</span>(records) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a><span class="co">#&gt; Success rate: 99 %</span></span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a></span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a><span class="co"># Export failed record IDs for investigation</span></span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a>failed_ids <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq_along</span>(migration_results), <span class="cf">function</span>(i) {</span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(migration_results[[i]]<span class="sc">$</span>error)) records[[i]]<span class="sc">$</span>id <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb14-79"><a href="#cb14-79" tabindex="-1"></a>})</span>
<span id="cb14-80"><a href="#cb14-80" tabindex="-1"></a>failed_ids <span class="ot">&lt;-</span> failed_ids[<span class="sc">!</span><span class="fu">is.na</span>(failed_ids)]</span>
<span id="cb14-81"><a href="#cb14-81" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(failed_ids) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb14-82"><a href="#cb14-82" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Failed record IDs:&quot;</span>, <span class="fu">paste</span>(<span class="fu">head</span>(failed_ids, <span class="dv">10</span>), <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>))</span>
<span id="cb14-83"><a href="#cb14-83" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(failed_ids) <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="fu">cat</span>(<span class="st">&quot;...&quot;</span>)</span>
<span id="cb14-84"><a href="#cb14-84" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-85"><a href="#cb14-85" tabindex="-1"></a>}</span>
<span id="cb14-86"><a href="#cb14-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-87"><a href="#cb14-87" tabindex="-1"></a><span class="co">#&gt; Failed record IDs: 38, 194</span></span></code></pre></div>
</div>
</div>
<div id="quick-reference-configuration-by-use-case" class="section level2">
<h2>Quick Reference: Configuration by Use Case</h2>
<pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                    Configuration Quick Reference                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Use Case              │ batch_size │ retry_attempts │ Notes               │
│   ──────────────────────┼────────────┼────────────────┼──────────────────── │
│   API calls             │ 20-50      │ 3-5            │ Respect rate limits │
│   File processing       │ 10-20      │ 1-2            │ Errors persistent   │
│   ML training           │ 5-10       │ 2              │ Long per-item time  │
│   Web scraping          │ 25-50      │ 3              │ Be respectful       │
│   Database migration    │ 50-100     │ 5              │ Transaction size    │
│   Parallel computation  │ 100-200    │ 2              │ Reduce overhead     │
│   Quick local ops       │ 500-1000   │ 1              │ Minimize I/O        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
<div id="next-steps" class="section level2">
<h2>Next Steps</h2>
<ul>
<li>🏆 <a href="best-practices.html">Best Practices</a> -
Production-ready patterns</li>
<li>🛡️ <a href="error-handling.html">Error Handling</a> - Advanced error
strategies</li>
<li>📋 <a href="session-management.html">Session Management</a> -
Checkpoint management</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
