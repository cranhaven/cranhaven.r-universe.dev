<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Session and Configuration Management</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Session and Configuration Management</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>SafeMapper manages sessions and checkpoints automatically, but
provides tools for inspection and control when needed. This guide covers
configuration, session management, and cleanup.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span></code></pre></div>
</div>
<div id="configuration" class="section level2">
<h2>Configuration</h2>
<div id="s_configure---customize-behavior" class="section level3">
<h3>s_configure() - Customize Behavior</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># View current defaults by calling with no arguments behavior</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Default configuration:</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># - batch_size = 100</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># - retry_attempts = 3</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># - auto_recover = TRUE</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># Customize settings</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">50</span>,       <span class="co"># Items per checkpoint</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">5</span>,    <span class="co"># Retries for failed batches</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="at">auto_recover =</span> <span class="cn">TRUE</span>    <span class="co"># Enable automatic recovery</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="configuration-options-explained" class="section level3">
<h3>Configuration Options Explained</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Configuration Options                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   batch_size (default: 100)                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Controls how often checkpoints are saved                          â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Small batch_size (10-50):                                        â”‚     â”‚
â”‚   â”‚    âœ… More frequent saves, less work lost on failure              â”‚     â”‚
â”‚   â”‚    âŒ Higher I/O overhead                                         â”‚     â”‚
â”‚   â”‚    Use for: Slow operations, unstable environments                â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Large batch_size (200-500):                                      â”‚     â”‚
â”‚   â”‚    âœ… Less I/O overhead, faster overall                           â”‚     â”‚
â”‚   â”‚    âŒ More work lost on failure                                   â”‚     â”‚
â”‚   â”‚    Use for: Fast operations, stable environments                  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   retry_attempts (default: 3)                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  How many times to retry a failed batch                           â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Low (1-2): For persistent errors (local computation)             â”‚     â”‚
â”‚   â”‚  Medium (3-5): For transient errors (network, APIs)               â”‚     â”‚
â”‚   â”‚  High (5-10): For very unreliable operations                      â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   auto_recover (default: TRUE)                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Whether to automatically resume from checkpoints                 â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  TRUE: Re-running same code resumes automatically                 â”‚     â”‚
â”‚   â”‚  FALSE: Always start fresh (useful for debugging)                 â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="configuration-recommendations" class="section level3">
<h3>Configuration Recommendations</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># For API calls (slow, potentially unstable)</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">20</span>,      <span class="co"># Save frequently</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">5</span>    <span class="co"># Handle transient errors</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># For local computation (fast, stable)</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">500</span>,     <span class="co"># Reduce I/O overhead</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">1</span>    <span class="co"># Errors are usually persistent</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co"># For development/debugging</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">10</span>,      <span class="co"># Easy to test recovery</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">1</span>,   <span class="co"># Fail fast</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">auto_recover =</span> <span class="cn">FALSE</span>  <span class="co"># Start fresh each run</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>)</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co"># Reset to defaults</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="fu">s_configure</span>()</span></code></pre></div>
</div>
</div>
<div id="session-ids" class="section level2">
<h2>Session IDs</h2>
<div id="automatic-vs-manual-session-ids" class="section level3">
<h3>Automatic vs Manual Session IDs</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Session ID Strategies                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Automatic (Default)                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  session_id = fingerprint(data_characteristics)                   â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Pros:                                                            â”‚     â”‚
â”‚   â”‚    âœ… Zero configuration needed                                   â”‚     â”‚
â”‚   â”‚    âœ… Same data automatically resumes                             â”‚     â”‚
â”‚   â”‚    âœ… Different data gets different session                       â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Cons:                                                            â”‚     â”‚
â”‚   â”‚    âš ï¸ Similar data might share session unexpectedly              â”‚     â”‚
â”‚   â”‚    âš ï¸ Code changes don&#39;t create new session                      â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   Manual (Explicit .session_id)                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  session_id = &quot;my_custom_id_v2&quot;                                   â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Pros:                                                            â”‚     â”‚
â”‚   â”‚    âœ… Full control over session identity                          â”‚     â”‚
â”‚   â”‚    âœ… Can version your computations                               â”‚     â”‚
â”‚   â”‚    âœ… Predictable behavior                                        â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Cons:                                                            â”‚     â”‚
â”‚   â”‚    âš ï¸ Must manage IDs yourself                                   â”‚     â”‚
â”‚   â”‚    âš ï¸ Must remember to update ID when needed                     â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="when-to-use-manual-session-ids" class="section level3">
<h3>When to Use Manual Session IDs</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Define example data and functions</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>algo_v1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>algo_v2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># Scenario 1: Versioned computation</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>result_v1 <span class="ot">&lt;-</span> <span class="fu">s_map</span>(data, algo_v1, <span class="at">.session_id =</span> <span class="st">&quot;analysis_v1&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; [5%] Processing items 1-20 of 20</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; Completed 20 items</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>result_v2 <span class="ot">&lt;-</span> <span class="fu">s_map</span>(data, algo_v2, <span class="at">.session_id =</span> <span class="st">&quot;analysis_v2&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; [5%] Processing items 1-20 of 20</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; Completed 20 items</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># Scenario 2: Named experiments</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>result_a <span class="ot">&lt;-</span> <span class="fu">s_map</span>(data, func, <span class="at">.session_id =</span> <span class="st">&quot;experiment_baseline&quot;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; [5%] Processing items 1-20 of 20</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; Completed 20 items</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>result_b <span class="ot">&lt;-</span> <span class="fu">s_map</span>(data, func, <span class="at">.session_id =</span> <span class="st">&quot;experiment_treatment&quot;</span>)</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; [5%] Processing items 1-20 of 20</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; Completed 20 items</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co"># Scenario 3: Date-based sessions</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">Sys.Date</span>(), <span class="st">&quot;%Y%m%d&quot;</span>)</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">s_map</span>(data, func, <span class="at">.session_id =</span> <span class="fu">paste0</span>(<span class="st">&quot;daily_job_&quot;</span>, today))</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; [5%] Processing items 1-20 of 20</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; Completed 20 items</span></span></code></pre></div>
</div>
</div>
<div id="checkpoint-storage" class="section level2">
<h2>Checkpoint Storage</h2>
<div id="storage-location" class="section level3">
<h3>Storage Location</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Checkpoints are stored in R&#39;s user cache directory:</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># - Linux:   ~/.cache/R/SafeMapper/checkpoints/</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># - macOS:   ~/Library/Caches/org.R-project.R/R/SafeMapper/checkpoints/</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># - Windows: %LOCALAPPDATA%/R/cache/R/SafeMapper/checkpoints/</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># Each checkpoint is an .rds file named after its session_id</span></span></code></pre></div>
</div>
<div id="checkpoint-file-structure" class="section level3">
<h3>Checkpoint File Structure</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Checkpoint File Contents                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   checkpoint_file.rds                                                        â”‚
â”‚   â”‚                                                                          â”‚
â”‚   â”œâ”€â”€ results                                                                â”‚
â”‚   â”‚   â””â”€â”€ List of computed results (up to completed items)                  â”‚
â”‚   â”‚                                                                          â”‚
â”‚   â””â”€â”€ metadata                                                               â”‚
â”‚       â”œâ”€â”€ session_id        : &quot;map_abc123def456&quot;                            â”‚
â”‚       â”œâ”€â”€ total_items       : 1000                                          â”‚
â”‚       â”œâ”€â”€ completed_items   : 500                                           â”‚
â”‚       â”œâ”€â”€ mode              : &quot;map&quot;                                         â”‚
â”‚       â”œâ”€â”€ created           : &quot;2026-01-23 10:30:00&quot;                         â”‚
â”‚       â””â”€â”€ last_updated      : &quot;2026-01-23 10:45:00&quot;                         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
</div>
<div id="session-cleanup" class="section level2">
<h2>Session Cleanup</h2>
<div id="s_clean_sessions---remove-old-checkpoints" class="section level3">
<h3>s_clean_sessions() - Remove Old Checkpoints</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Clean sessions older than 7 days (default)</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">older_than_days =</span> <span class="dv">7</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; No session files found</span></span></code></pre></div>
</div>
<div id="cleanup-options" class="section level3">
<h3>Cleanup Options</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Clean by age</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">older_than_days =</span> <span class="dv">30</span>)  <span class="co"># Remove sessions &gt; 30 days old</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># Clean specific sessions</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">session_ids =</span> <span class="fu">c</span>(<span class="st">&quot;old_experiment&quot;</span>, <span class="st">&quot;failed_job&quot;</span>))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Clean by status</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">status_filter =</span> <span class="st">&quot;failed&quot;</span>)     <span class="co"># Only failed sessions</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">status_filter =</span> <span class="st">&quot;corrupted&quot;</span>)  <span class="co"># Only corrupted sessions</span></span></code></pre></div>
</div>
<div id="cleanup-workflow" class="section level3">
<h3>Cleanup Workflow</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Checkpoint Lifecycle                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   1. Creation                                                                â”‚
â”‚      s_map() starts â”€â”€â–º Checkpoint created                                  â”‚
â”‚                                                                              â”‚
â”‚   2. Updates                                                                 â”‚
â”‚      Each batch complete â”€â”€â–º Checkpoint updated                             â”‚
â”‚                                                                              â”‚
â”‚   3. Automatic Deletion (on success)                                         â”‚
â”‚      All items complete â”€â”€â–º Checkpoint deleted automatically                â”‚
â”‚                                                                              â”‚
â”‚   4. Manual Cleanup (for interrupted sessions)                               â”‚
â”‚      Task abandoned â”€â”€â–º Use s_clean_sessions()                              â”‚
â”‚                                                                              â”‚
â”‚   Recommended Schedule:                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Daily:   s_clean_sessions(older_than_days = 7)                   â”‚     â”‚
â”‚   â”‚  Weekly:  s_clean_sessions(status_filter = &quot;failed&quot;)              â”‚     â”‚
â”‚   â”‚  Monthly: Check total disk usage of checkpoint directory          â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
</div>
<div id="workflow-examples" class="section level2">
<h2>Workflow Examples</h2>
<div id="example-1-long-running-daily-job" class="section level3">
<h3>Example 1: Long-Running Daily Job</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># daily_job.R</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># Configure for production</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">100</span>,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">3</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co"># Use date-based session ID for predictable behavior</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>job_id <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;daily_process_&quot;</span>, <span class="fu">format</span>(<span class="fu">Sys.Date</span>(), <span class="st">&quot;%Y%m%d&quot;</span>))</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co"># Run the job</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  large_dataset,</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  process_record,</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  <span class="at">.session_id =</span> job_id</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co"># Clean up old sessions at the end</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">older_than_days =</span> <span class="dv">7</span>)</span></code></pre></div>
</div>
<div id="example-2-development-and-debugging" class="section level3">
<h3>Example 2: Development and Debugging</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># development.R</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Configure for debugging</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">10</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">1</span>,</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="at">auto_recover =</span> <span class="cn">FALSE</span>  <span class="co"># Always start fresh</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co"># Test with small dataset</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">head</span>(full_data, <span class="dv">50</span>)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co"># Run and iterate</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(test_data, my_function)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co"># When ready for production, change config</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">100</span>,</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">3</span>,</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  <span class="at">auto_recover =</span> <span class="cn">TRUE</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="example-3-multiple-related-tasks" class="section level3">
<h3>Example 3: Multiple Related Tasks</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># multi_stage_pipeline.R</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co"># Stage 1: Data extraction</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>stage1_results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  sources,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  extract_data,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;pipeline_stage1_v1&quot;</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co"># Stage 2: Transformation</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>stage2_results <span class="ot">&lt;-</span> <span class="fu">s_map</span>(</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  stage1_results,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  transform_data,</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;pipeline_stage2_v1&quot;</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co"># Stage 3: Loading</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="fu">s_walk</span>(</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  stage2_results,</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  load_to_database,</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  <span class="at">.session_id =</span> <span class="st">&quot;pipeline_stage3_v1&quot;</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>)</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co"># If pipeline changes, increment version</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co"># .session_id = &quot;pipeline_stage1_v2&quot;</span></span></code></pre></div>
</div>
</div>
<div id="best-practices" class="section level2">
<h2>Best Practices</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Session Management Best Practices                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   1. Configuration                                                           â”‚
â”‚      â”œâ”€â”€ Set config at script start for consistency                         â”‚
â”‚      â”œâ”€â”€ Use environment-specific configs (dev/prod)                        â”‚
â”‚      â””â”€â”€ Document your configuration choices                                â”‚
â”‚                                                                              â”‚
â”‚   2. Session IDs                                                             â”‚
â”‚      â”œâ”€â”€ Use auto-generated IDs for one-off scripts                        â”‚
â”‚      â”œâ”€â”€ Use manual IDs for repeatable jobs                                â”‚
â”‚      â”œâ”€â”€ Include version numbers when algorithms change                     â”‚
â”‚      â””â”€â”€ Include dates for time-sensitive jobs                              â”‚
â”‚                                                                              â”‚
â”‚   3. Cleanup                                                                 â”‚
â”‚      â”œâ”€â”€ Run cleanup regularly (daily or weekly)                           â”‚
â”‚      â”œâ”€â”€ Monitor checkpoint directory size                                  â”‚
â”‚      â”œâ”€â”€ Clean failed sessions after investigation                         â”‚
â”‚      â””â”€â”€ Don&#39;t clean sessions you might need to resume                     â”‚
â”‚                                                                              â”‚
â”‚   4. Monitoring                                                              â”‚
â”‚      â”œâ”€â”€ Use session IDs that are easy to identify                         â”‚
â”‚      â”œâ”€â”€ Log session IDs for tracking                                      â”‚
â”‚      â””â”€â”€ Set up alerts for sessions that never complete                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="troubleshooting" class="section level2">
<h2>Troubleshooting</h2>
<div id="checkpoint-not-resuming" class="section level3">
<h3>Checkpoint Not Resuming</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Possible causes:</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># 1. auto_recover is FALSE</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">s_configure</span>(<span class="at">auto_recover =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># 2. Data changed (different fingerprint)</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co"># Use explicit session_id to force same session</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">s_map</span>(data, func, <span class="at">.session_id =</span> <span class="st">&quot;fixed_session&quot;</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co"># 3. Checkpoint was deleted</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># Check if file exists in checkpoint directory</span></span></code></pre></div>
</div>
<div id="too-many-checkpoint-files" class="section level3">
<h3>Too Many Checkpoint Files</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Aggressive cleanup</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">older_than_days =</span> <span class="dv">1</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; No session files found</span></span></code></pre></div>
</div>
<div id="checkpoint-corrupted" class="section level3">
<h3>Checkpoint Corrupted</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Clean corrupted checkpoints</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">s_clean_sessions</span>(<span class="at">status_filter =</span> <span class="st">&quot;corrupted&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; No session files found</span></span></code></pre></div>
</div>
</div>
<div id="next-steps" class="section level2">
<h2>Next Steps</h2>
<ul>
<li>ğŸ¯ <a href="real-world-examples.html">Real-World Examples</a> - See
session management in action</li>
<li>ğŸ† <a href="best-practices.html">Best Practices</a> - Production
patterns</li>
<li>ğŸ”§ <a href="map-functions.html">Map Functions</a> - Core function
reference</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
