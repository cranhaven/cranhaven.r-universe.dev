---
title: "Session and Configuration Management"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Session and Configuration Management}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7,
  fig.height = 5
)
```

## Overview

SafeMapper manages sessions and checkpoints automatically, but provides tools for inspection and control when needed. This guide covers configuration, session management, and cleanup.

```{r}
library(SafeMapper)
```

## Configuration

### s_configure() - Customize Behavior

```{r}
# View current defaults by calling with no arguments behavior
# Default configuration:
# - batch_size = 100
# - retry_attempts = 3
# - auto_recover = TRUE

# Customize settings
s_configure(
  batch_size = 50,       # Items per checkpoint
  retry_attempts = 5,    # Retries for failed batches
  auto_recover = TRUE    # Enable automatic recovery
)
```

### Configuration Options Explained

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Configuration Options                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   batch_size (default: 100)                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Controls how often checkpoints are saved                          â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Small batch_size (10-50):                                        â”‚     â”‚
â”‚   â”‚    âœ… More frequent saves, less work lost on failure              â”‚     â”‚
â”‚   â”‚    âŒ Higher I/O overhead                                         â”‚     â”‚
â”‚   â”‚    Use for: Slow operations, unstable environments                â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Large batch_size (200-500):                                      â”‚     â”‚
â”‚   â”‚    âœ… Less I/O overhead, faster overall                           â”‚     â”‚
â”‚   â”‚    âŒ More work lost on failure                                   â”‚     â”‚
â”‚   â”‚    Use for: Fast operations, stable environments                  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   retry_attempts (default: 3)                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  How many times to retry a failed batch                           â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Low (1-2): For persistent errors (local computation)             â”‚     â”‚
â”‚   â”‚  Medium (3-5): For transient errors (network, APIs)               â”‚     â”‚
â”‚   â”‚  High (5-10): For very unreliable operations                      â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   auto_recover (default: TRUE)                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Whether to automatically resume from checkpoints                 â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  TRUE: Re-running same code resumes automatically                 â”‚     â”‚
â”‚   â”‚  FALSE: Always start fresh (useful for debugging)                 â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Configuration Recommendations

```{r}
# For API calls (slow, potentially unstable)
s_configure(
  batch_size = 20,      # Save frequently
  retry_attempts = 5    # Handle transient errors
)

# For local computation (fast, stable)
s_configure(
  batch_size = 500,     # Reduce I/O overhead
  retry_attempts = 1    # Errors are usually persistent
)

# For development/debugging
s_configure(
  batch_size = 10,      # Easy to test recovery
  retry_attempts = 1,   # Fail fast
  auto_recover = FALSE  # Start fresh each run
)

# Reset to defaults
s_configure()
```

## Session IDs

### Automatic vs Manual Session IDs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Session ID Strategies                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Automatic (Default)                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  session_id = fingerprint(data_characteristics)                   â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Pros:                                                            â”‚     â”‚
â”‚   â”‚    âœ… Zero configuration needed                                   â”‚     â”‚
â”‚   â”‚    âœ… Same data automatically resumes                             â”‚     â”‚
â”‚   â”‚    âœ… Different data gets different session                       â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Cons:                                                            â”‚     â”‚
â”‚   â”‚    âš ï¸ Similar data might share session unexpectedly              â”‚     â”‚
â”‚   â”‚    âš ï¸ Code changes don't create new session                      â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   Manual (Explicit .session_id)                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  session_id = "my_custom_id_v2"                                   â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Pros:                                                            â”‚     â”‚
â”‚   â”‚    âœ… Full control over session identity                          â”‚     â”‚
â”‚   â”‚    âœ… Can version your computations                               â”‚     â”‚
â”‚   â”‚    âœ… Predictable behavior                                        â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  Cons:                                                            â”‚     â”‚
â”‚   â”‚    âš ï¸ Must manage IDs yourself                                   â”‚     â”‚
â”‚   â”‚    âš ï¸ Must remember to update ID when needed                     â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### When to Use Manual Session IDs

```{r}
# Define example data and functions
data <- 1:20
algo_v1 <- function(x) x^2
algo_v2 <- function(x) x^3

# Scenario 1: Versioned computation
result_v1 <- s_map(data, algo_v1, .session_id = "analysis_v1")
result_v2 <- s_map(data, algo_v2, .session_id = "analysis_v2")

# Scenario 2: Named experiments
func <- function(x) x * 2
result_a <- s_map(data, func, .session_id = "experiment_baseline")
result_b <- s_map(data, func, .session_id = "experiment_treatment")

# Scenario 3: Date-based sessions
today <- format(Sys.Date(), "%Y%m%d")
result <- s_map(data, func, .session_id = paste0("daily_job_", today))
```

## Checkpoint Storage

### Storage Location

```{r}
# Checkpoints are stored in R's user cache directory:
# - Linux:   ~/.cache/R/SafeMapper/checkpoints/
# - macOS:   ~/Library/Caches/org.R-project.R/R/SafeMapper/checkpoints/
# - Windows: %LOCALAPPDATA%/R/cache/R/SafeMapper/checkpoints/

# Each checkpoint is an .rds file named after its session_id
```

### Checkpoint File Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Checkpoint File Contents                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   checkpoint_file.rds                                                        â”‚
â”‚   â”‚                                                                          â”‚
â”‚   â”œâ”€â”€ results                                                                â”‚
â”‚   â”‚   â””â”€â”€ List of computed results (up to completed items)                  â”‚
â”‚   â”‚                                                                          â”‚
â”‚   â””â”€â”€ metadata                                                               â”‚
â”‚       â”œâ”€â”€ session_id        : "map_abc123def456"                            â”‚
â”‚       â”œâ”€â”€ total_items       : 1000                                          â”‚
â”‚       â”œâ”€â”€ completed_items   : 500                                           â”‚
â”‚       â”œâ”€â”€ mode              : "map"                                         â”‚
â”‚       â”œâ”€â”€ created           : "2026-01-23 10:30:00"                         â”‚
â”‚       â””â”€â”€ last_updated      : "2026-01-23 10:45:00"                         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Session Cleanup

### s_clean_sessions() - Remove Old Checkpoints

```{r}
# Clean sessions older than 7 days (default)
s_clean_sessions(older_than_days = 7)
```

### Cleanup Options

```{r eval=FALSE}
# Clean by age
s_clean_sessions(older_than_days = 30)  # Remove sessions > 30 days old

# Clean specific sessions
s_clean_sessions(session_ids = c("old_experiment", "failed_job"))

# Clean by status
s_clean_sessions(status_filter = "failed")     # Only failed sessions
s_clean_sessions(status_filter = "corrupted")  # Only corrupted sessions
```

### Cleanup Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Checkpoint Lifecycle                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   1. Creation                                                                â”‚
â”‚      s_map() starts â”€â”€â–º Checkpoint created                                  â”‚
â”‚                                                                              â”‚
â”‚   2. Updates                                                                 â”‚
â”‚      Each batch complete â”€â”€â–º Checkpoint updated                             â”‚
â”‚                                                                              â”‚
â”‚   3. Automatic Deletion (on success)                                         â”‚
â”‚      All items complete â”€â”€â–º Checkpoint deleted automatically                â”‚
â”‚                                                                              â”‚
â”‚   4. Manual Cleanup (for interrupted sessions)                               â”‚
â”‚      Task abandoned â”€â”€â–º Use s_clean_sessions()                              â”‚
â”‚                                                                              â”‚
â”‚   Recommended Schedule:                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Daily:   s_clean_sessions(older_than_days = 7)                   â”‚     â”‚
â”‚   â”‚  Weekly:  s_clean_sessions(status_filter = "failed")              â”‚     â”‚
â”‚   â”‚  Monthly: Check total disk usage of checkpoint directory          â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Workflow Examples

### Example 1: Long-Running Daily Job

```{r eval=FALSE}
# daily_job.R

library(SafeMapper)

# Configure for production
s_configure(
  batch_size = 100,
  retry_attempts = 3
)

# Use date-based session ID for predictable behavior
job_id <- paste0("daily_process_", format(Sys.Date(), "%Y%m%d"))

# Run the job
results <- s_map(
  large_dataset,
  process_record,
  .session_id = job_id
)

# Clean up old sessions at the end
s_clean_sessions(older_than_days = 7)
```

### Example 2: Development and Debugging

```{r eval=FALSE}
# development.R

library(SafeMapper)

# Configure for debugging
s_configure(
  batch_size = 10,
  retry_attempts = 1,
  auto_recover = FALSE  # Always start fresh
)

# Test with small dataset
test_data <- head(full_data, 50)

# Run and iterate
results <- s_map(test_data, my_function)

# When ready for production, change config
s_configure(
  batch_size = 100,
  retry_attempts = 3,
  auto_recover = TRUE
)
```

### Example 3: Multiple Related Tasks

```{r eval=FALSE}
# multi_stage_pipeline.R

library(SafeMapper)

# Stage 1: Data extraction
stage1_results <- s_map(
  sources,
  extract_data,
  .session_id = "pipeline_stage1_v1"
)

# Stage 2: Transformation
stage2_results <- s_map(
  stage1_results,
  transform_data,
  .session_id = "pipeline_stage2_v1"
)

# Stage 3: Loading
s_walk(
  stage2_results,
  load_to_database,
  .session_id = "pipeline_stage3_v1"
)

# If pipeline changes, increment version
# .session_id = "pipeline_stage1_v2"
```

## Best Practices

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Session Management Best Practices                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   1. Configuration                                                           â”‚
â”‚      â”œâ”€â”€ Set config at script start for consistency                         â”‚
â”‚      â”œâ”€â”€ Use environment-specific configs (dev/prod)                        â”‚
â”‚      â””â”€â”€ Document your configuration choices                                â”‚
â”‚                                                                              â”‚
â”‚   2. Session IDs                                                             â”‚
â”‚      â”œâ”€â”€ Use auto-generated IDs for one-off scripts                        â”‚
â”‚      â”œâ”€â”€ Use manual IDs for repeatable jobs                                â”‚
â”‚      â”œâ”€â”€ Include version numbers when algorithms change                     â”‚
â”‚      â””â”€â”€ Include dates for time-sensitive jobs                              â”‚
â”‚                                                                              â”‚
â”‚   3. Cleanup                                                                 â”‚
â”‚      â”œâ”€â”€ Run cleanup regularly (daily or weekly)                           â”‚
â”‚      â”œâ”€â”€ Monitor checkpoint directory size                                  â”‚
â”‚      â”œâ”€â”€ Clean failed sessions after investigation                         â”‚
â”‚      â””â”€â”€ Don't clean sessions you might need to resume                     â”‚
â”‚                                                                              â”‚
â”‚   4. Monitoring                                                              â”‚
â”‚      â”œâ”€â”€ Use session IDs that are easy to identify                         â”‚
â”‚      â”œâ”€â”€ Log session IDs for tracking                                      â”‚
â”‚      â””â”€â”€ Set up alerts for sessions that never complete                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Troubleshooting

### Checkpoint Not Resuming

```{r eval=FALSE}
# Possible causes:
# 1. auto_recover is FALSE
s_configure(auto_recover = TRUE)

# 2. Data changed (different fingerprint)
# Use explicit session_id to force same session
result <- s_map(data, func, .session_id = "fixed_session")

# 3. Checkpoint was deleted
# Check if file exists in checkpoint directory
```

### Too Many Checkpoint Files

```{r}
# Aggressive cleanup
s_clean_sessions(older_than_days = 1)
```

### Checkpoint Corrupted

```{r}
# Clean corrupted checkpoints
s_clean_sessions(status_filter = "corrupted")
```

## Next Steps

- ğŸ¯ [Real-World Examples](real-world-examples.html) - See session management in action
- ğŸ† [Best Practices](best-practices.html) - Production patterns
- ğŸ”§ [Map Functions](map-functions.html) - Core function reference
