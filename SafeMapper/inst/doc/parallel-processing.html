<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Parallel Processing with SafeMapper</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Parallel Processing with SafeMapper</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>SafeMapper provides fault-tolerant parallel processing through the
<code>s_future_*</code> family of functions. These are drop-in
replacements for <code>furrr</code> functions with automatic
checkpointing.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span></code></pre></div>
</div>
<div id="why-parallel-fault-tolerance" class="section level2">
<h2>Why Parallel + Fault Tolerance?</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    The Challenge of Parallel Processing                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Traditional Parallel Processing:                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Worker 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                   â”‚     â”‚
â”‚   â”‚  Worker 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                              â”‚     â”‚
â”‚   â”‚  Worker 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                         â”‚     â”‚
â”‚   â”‚  Worker 4: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âŒ CRASH!                 â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   Result: ALL workers&#39; progress lost, must restart everything               â”‚
â”‚                                                                              â”‚
â”‚   SafeMapper Parallel Processing:                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Worker 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ğŸ’¾                                â”‚     â”‚
â”‚   â”‚  Worker 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ğŸ’¾                           â”‚     â”‚
â”‚   â”‚  Worker 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ğŸ’¾                      â”‚     â”‚
â”‚   â”‚  Worker 4: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âŒ CRASH!                 â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   Result: Resume from last checkpoint, only redo partial work               â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="prerequisites" class="section level2">
<h2>Prerequisites</h2>
<p>SafeMapperâ€™s parallel functions require the <code>furrr</code> and
<code>future</code> packages:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;furrr&quot;</span>, <span class="st">&quot;future&quot;</span>))</span></code></pre></div>
</div>
<div id="setting-up-parallel-processing" class="section level2">
<h2>Setting Up Parallel Processing</h2>
<div id="step-1-load-required-packages" class="section level3">
<h3>Step 1: Load Required Packages</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(future)</span></code></pre></div>
</div>
<div id="step-2-configure-workers" class="section level3">
<h3>Step 2: Configure Workers</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Use multiple R sessions (works on all platforms)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">4</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># Or use forked processes (faster, but Unix/Mac only)</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># plan(multicore, workers = 4)</span></span></code></pre></div>
</div>
<div id="step-3-use-s_future_-functions" class="section level3">
<h3>Step 3: Use s_future_* Functions</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Instead of furrr::future_map()</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">s_future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, expensive_function)</span></code></pre></div>
</div>
</div>
<div id="available-parallel-functions" class="section level2">
<h2>Available Parallel Functions</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    s_future_* Function Family                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Single-Input                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  s_future_map      â”€â”€â–º Parallel map, returns list                  â”‚    â”‚
â”‚   â”‚  s_future_map_chr  â”€â”€â–º Returns character vector                    â”‚    â”‚
â”‚   â”‚  s_future_map_dbl  â”€â”€â–º Returns numeric vector                      â”‚    â”‚
â”‚   â”‚  s_future_map_int  â”€â”€â–º Returns integer vector                      â”‚    â”‚
â”‚   â”‚  s_future_map_lgl  â”€â”€â–º Returns logical vector                      â”‚    â”‚
â”‚   â”‚  s_future_map_dfr  â”€â”€â–º Returns row-bound data frame                â”‚    â”‚
â”‚   â”‚  s_future_map_dfc  â”€â”€â–º Returns column-bound data frame             â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚   Dual-Input                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  s_future_map2      â”€â”€â–º Parallel map with two inputs               â”‚    â”‚
â”‚   â”‚  s_future_map2_chr  â”€â”€â–º Returns character vector                   â”‚    â”‚
â”‚   â”‚  s_future_map2_dbl  â”€â”€â–º Returns numeric vector                     â”‚    â”‚
â”‚   â”‚  s_future_map2_int  â”€â”€â–º Returns integer vector                     â”‚    â”‚
â”‚   â”‚  s_future_map2_lgl  â”€â”€â–º Returns logical vector                     â”‚    â”‚
â”‚   â”‚  s_future_map2_dfr  â”€â”€â–º Returns row-bound data frame               â”‚    â”‚
â”‚   â”‚  s_future_map2_dfc  â”€â”€â–º Returns column-bound data frame            â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚   Multi-Input &amp; Side Effects                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  s_future_pmap     â”€â”€â–º Parallel map with multiple inputs           â”‚    â”‚
â”‚   â”‚  s_future_imap     â”€â”€â–º Parallel indexed map                        â”‚    â”‚
â”‚   â”‚  s_future_walk     â”€â”€â–º Parallel side effects                       â”‚    â”‚
â”‚   â”‚  s_future_walk2    â”€â”€â–º Parallel dual-input side effects            â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="basic-usage-examples" class="section level2">
<h2>Basic Usage Examples</h2>
<div id="s_future_map" class="section level3">
<h3>s_future_map</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># CPU-intensive computation</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">s_future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="cf">function</span>(x) {</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.1</span>)  <span class="co"># Simulate work</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>})</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># Reset to sequential</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span></code></pre></div>
</div>
<div id="s_future_map2" class="section level3">
<h3>s_future_map2</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">51</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># Process pairs in parallel</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_future_map2</span>(x, y, <span class="cf">function</span>(a, b) {</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  a <span class="sc">*</span> b</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>})</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span></code></pre></div>
</div>
<div id="s_future_pmap" class="section level3">
<h3>s_future_pmap</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">2</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">b =</span> <span class="dv">31</span><span class="sc">:</span><span class="dv">60</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">c =</span> <span class="dv">61</span><span class="sc">:</span><span class="dv">90</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># Process multiple inputs in parallel</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_future_pmap</span>(params, <span class="cf">function</span>(a, b, c) {</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.1</span>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  a <span class="sc">+</span> b <span class="sc">+</span> c</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>})</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span></code></pre></div>
</div>
</div>
<div id="execution-flow" class="section level2">
<h2>Execution Flow</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Parallel Processing Flow                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  s_future_map(data, func)                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  1. Check for existing checkpoint                                    â”‚   â”‚
â”‚   â”‚     â”œâ”€â”€ Found: Resume from checkpoint                               â”‚   â”‚
â”‚   â”‚     â””â”€â”€ Not found: Start fresh                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  2. Split data into batches                                          â”‚   â”‚
â”‚   â”‚     Data: [1, 2, 3, ..., 1000]                                      â”‚   â”‚
â”‚   â”‚     Batch 1: [1-100], Batch 2: [101-200], ...                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  3. Process each batch with furrr::future_map                        â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚   â”‚     â”‚  Batch items distributed to workers                     â”‚     â”‚   â”‚
â”‚   â”‚     â”‚                                                         â”‚     â”‚   â”‚
â”‚   â”‚     â”‚  Worker 1: [1-25]    â”€â”€â”€â”€â–º  Results [1-25]             â”‚     â”‚   â”‚
â”‚   â”‚     â”‚  Worker 2: [26-50]   â”€â”€â”€â”€â–º  Results [26-50]            â”‚     â”‚   â”‚
â”‚   â”‚     â”‚  Worker 3: [51-75]   â”€â”€â”€â”€â–º  Results [51-75]            â”‚     â”‚   â”‚
â”‚   â”‚     â”‚  Worker 4: [76-100]  â”€â”€â”€â”€â–º  Results [76-100]           â”‚     â”‚   â”‚
â”‚   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  4. Save checkpoint after each batch                                 â”‚   â”‚
â”‚   â”‚     ğŸ’¾ Checkpoint: &quot;Batch 1 complete, 100/1000 items&quot;               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  5. Repeat until all batches complete                                â”‚   â”‚
â”‚   â”‚     Then: Delete checkpoint, return full results                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="configuration-options" class="section level2">
<h2>Configuration Options</h2>
<div id="batch-size-for-parallel" class="section level3">
<h3>Batch Size for Parallel</h3>
<p>For parallel processing, batch size affects both checkpoint frequency
and parallel efficiency:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Larger batches = more efficient parallel execution</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># But less frequent checkpoints</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">s_configure</span>(<span class="at">batch_size =</span> <span class="dv">200</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># Smaller batches = more frequent checkpoints  </span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># But more overhead from parallelization</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">s_configure</span>(<span class="at">batch_size =</span> <span class="dv">50</span>)</span></code></pre></div>
</div>
<div id="furrr-options" class="section level3">
<h3>furrr Options</h3>
<p>Pass furrr options through <code>.options</code> parameter:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Custom furrr options</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>opts <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,           <span class="co"># Reproducible random numbers</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">globals =</span> <span class="cn">TRUE</span>,       <span class="co"># Export global variables</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">packages =</span> <span class="st">&quot;dplyr&quot;</span>    <span class="co"># Load packages in workers</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">s_future_map</span>(</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  my_function,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="at">.options =</span> opts</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="when-to-use-parallel-processing" class="section level2">
<h2>When to Use Parallel Processing</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Decision Tree: Sequential vs Parallel                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Is each operation CPU-intensive (&gt; 100ms)?                                â”‚
â”‚   â”‚                                                                          â”‚
â”‚   â”œâ”€â”€ YES â”€â”€â–º Is total data size &gt; 100 items?                               â”‚
â”‚   â”‚           â”‚                                                              â”‚
â”‚   â”‚           â”œâ”€â”€ YES â”€â”€â–º âœ… Use s_future_map (parallel)                    â”‚
â”‚   â”‚           â”‚                                                              â”‚
â”‚   â”‚           â””â”€â”€ NO â”€â”€â”€â–º âš ï¸  Overhead may outweigh benefit                 â”‚
â”‚   â”‚                        Use s_map (sequential)                           â”‚
â”‚   â”‚                                                                          â”‚
â”‚   â””â”€â”€ NO â”€â”€â”€â–º Is the operation I/O bound (network, disk)?                   â”‚
â”‚               â”‚                                                              â”‚
â”‚               â”œâ”€â”€ YES â”€â”€â–º âš ï¸  Parallel may help, but consider:              â”‚
â”‚               â”‚              - Rate limits                                  â”‚
â”‚               â”‚              - Connection pools                             â”‚
â”‚               â”‚              - Resource contention                          â”‚
â”‚               â”‚                                                              â”‚
â”‚               â””â”€â”€ NO â”€â”€â”€â–º âŒ Use s_map (sequential)                         â”‚
â”‚                            Parallel overhead not worth it                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<div id="good-use-cases-for-parallel" class="section level3">
<h3>Good Use Cases for Parallel</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># 1. Heavy computations</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">s_future_map</span>(large_datasets, <span class="cf">function</span>(data) {</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="co"># Complex statistical model fitting</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">fit_complex_model</span>(data)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>})</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># 2. Image/file processing</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="fu">s_future_map</span>(image_files, <span class="cf">function</span>(file) {</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="co"># CPU-intensive image transformation</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  <span class="fu">process_image</span>(file)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>})</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co"># 3. Simulations</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="fu">s_future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(i) {</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  <span class="co"># Monte Carlo simulation</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>  <span class="fu">run_simulation</span>(<span class="at">seed =</span> i)</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="poor-use-cases-for-parallel" class="section level3">
<h3>Poor Use Cases for Parallel</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># 1. Simple operations (overhead &gt; benefit)</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># DON&#39;T:</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">s_future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span> .x <span class="sc">+</span> <span class="dv">1</span>)  <span class="co"># Too simple</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># DO:</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">s_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span> .x <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co"># 2. Rate-limited API calls</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># DON&#39;T:</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="fu">s_future_map</span>(urls, fetch_api)  <span class="co"># May hit rate limits</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># DO:</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="fu">s_map</span>(urls, fetch_api)  <span class="co"># Sequential respects rate limits</span></span></code></pre></div>
</div>
</div>
<div id="handling-progress" class="section level2">
<h2>Handling Progress</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Enable progress bar</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">s_future_map</span>(</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  slow_function,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="error-handling-in-parallel" class="section level2">
<h2>Error Handling in Parallel</h2>
<p>When errors occur in parallel execution, SafeMapper handles them
gracefully:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Error Handling in Parallel                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Batch Processing with Error:                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Batch 1: [1-100]   âœ… Success  â”€â”€â–º ğŸ’¾ Save checkpoint            â”‚     â”‚
â”‚   â”‚  Batch 2: [101-200] âœ… Success  â”€â”€â–º ğŸ’¾ Save checkpoint            â”‚     â”‚
â”‚   â”‚  Batch 3: [201-300] âŒ Error in worker                            â”‚     â”‚
â”‚   â”‚                     â”‚                                              â”‚     â”‚
â”‚   â”‚                     â–¼                                              â”‚     â”‚
â”‚   â”‚              Retry entire batch (up to N attempts)                â”‚     â”‚
â”‚   â”‚                     â”‚                                              â”‚     â”‚
â”‚   â”‚                     â”œâ”€â”€ Success â”€â”€â–º Continue                      â”‚     â”‚
â”‚   â”‚                     â””â”€â”€ Fail â”€â”€â”€â”€â–º Error (200 items saved)        â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚   On re-run: Resume from item 201                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="best-practices" class="section level2">
<h2>Best Practices</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Parallel Processing Best Practices                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   1. Choose the Right Number of Workers                                      â”‚
â”‚      â”œâ”€â”€ CPU-bound: workers = parallel::detectCores() - 1                   â”‚
â”‚      â””â”€â”€ Memory-intensive: fewer workers to avoid OOM                       â”‚
â”‚                                                                              â”‚
â”‚   2. Mind Memory Usage                                                       â”‚
â”‚      â”œâ”€â”€ Each worker gets a copy of global data                            â”‚
â”‚      â”œâ”€â”€ Use .options$globals to minimize data transfer                     â”‚
â”‚      â””â”€â”€ Consider chunking very large datasets                             â”‚
â”‚                                                                              â”‚
â”‚   3. Set Appropriate Batch Sizes                                             â”‚
â”‚      â”œâ”€â”€ Too small: High checkpoint I/O overhead                           â”‚
â”‚      â”œâ”€â”€ Too large: More work lost on failure                              â”‚
â”‚      â””â”€â”€ Rule of thumb: 1-5 minutes of work per batch                      â”‚
â”‚                                                                              â”‚
â”‚   4. Handle Random Seeds                                                     â”‚
â”‚      â”œâ”€â”€ Use .options$seed for reproducibility                             â”‚
â”‚      â””â”€â”€ Each worker gets independent but reproducible stream              â”‚
â”‚                                                                              â”‚
â”‚   5. Clean Up Resources                                                      â”‚
â”‚      â”œâ”€â”€ Call plan(sequential) when done                                   â”‚
â”‚      â””â”€â”€ Or let R clean up on exit                                         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
</div>
<div id="complete-example" class="section level2">
<h2>Complete Example</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">library</span>(SafeMapper)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># Configure parallel backend</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">4</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co"># Configure SafeMapper</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="fu">s_configure</span>(</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">100</span>,     <span class="co"># Checkpoint every 100 items</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="at">retry_attempts =</span> <span class="dv">3</span>    <span class="co"># Retry failed batches 3 times</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co"># Define your processing function</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>process_item <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)  <span class="co"># Simulate work</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>  result <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>}</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co"># Run with fault tolerance</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">s_future_map</span>(</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>,</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>  process_item,</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>  <span class="at">.progress =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>  <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>)</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co"># Clean up</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co"># If interrupted, just re-run the same code!</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co"># It will resume from the last checkpoint.</span></span></code></pre></div>
</div>
<div id="next-steps" class="section level2">
<h2>Next Steps</h2>
<ul>
<li>ğŸ›¡ï¸ <a href="error-handling.html">Error Handling</a> - Robust error
handling strategies</li>
<li>ğŸ“‹ <a href="session-management.html">Session Management</a> - Manage
checkpoints</li>
<li>ğŸ¯ <a href="real-world-examples.html">Real-World Examples</a> - See
parallel processing in action</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
