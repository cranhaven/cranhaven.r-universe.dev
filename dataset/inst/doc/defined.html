<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>defined: Semantically Enriched Vectors</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">defined: Semantically Enriched Vectors</h1>



<p>The <code>dataset</code> package extends R’s native data structures
with machine-readable metadata. It follows a <em>semantic
early-binding</em> approach, which means metadata is embedded as soon as
the data is created, making datasets suitable for long-term reuse,
FAIR-compliant publishing, and integration into semantic web
systems.</p>
<p><code>defined</code> works naturally with data structured according
to tidy data principles (Wickham, 2014), where each variable is a
column, each observation is a row, and each type of observational unit
forms a table. It adds an additional semantic layer to individual
vectors so their meaning is explicit, consistent, and
machine-readable.</p>
<p>This vignette focuses specifically on the <code>defined</code>
function, which you can use to create a semantically enriched vector.
For details on semantically enriched data frames, see
<code>vignette(&quot;dataset_df&quot;, package = &quot;dataset&quot;)</code>.</p>
<div id="purpose" class="section level2">
<h2>Purpose</h2>
<p>The <code>defined()</code> function helps you create
<strong>semantically rich labelled vectors</strong> that are easier
to:</p>
<ul>
<li>understand by humans,</li>
<li>validate and process by machines,</li>
<li>ensure consistency when combining data from multiple sources,</li>
<li>share across tools, teams, and domains.</li>
</ul>
<p>By attaching metadata at creation time, <code>defined</code> prevents
the loss of context and meaning that often occurs when data is exchanged
or archived. This approach supports the FAIR data principles (Findable,
Accessible, Interoperable, Reusable) and facilitates integration into
semantic web systems.</p>
</div>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dataset)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;gdp&quot;</span>)</span></code></pre></div>
<p>We’ll start by wrapping a numeric GDP vector using
<code>defined()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>gdp_1 <span class="ot">&lt;-</span> <span class="fu">defined</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  gdp<span class="sc">$</span>gdp,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Gross Domestic Product&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">unit =</span> <span class="st">&quot;CP_MEUR&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">concept =</span> <span class="st">&quot;http://data.europa.eu/83i/aa/GDP&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>defined()</code> class builds on labelled vectors by adding
rich metadata:</p>
<ul>
<li><strong>label</strong> — a description of what the variable
represents</li>
<li><strong>unit</strong> — a short code for the measurement unit (e.g.,
<code>CP_MEUR</code>)</li>
<li><strong>definition</strong> — a URI linking to a concept or
standard</li>
<li><strong>namespace</strong> — optional, for classifying coded values
(e.g., SDMX codes)</li>
</ul>
<p>This is particularly useful for reproducible research,
standard-compliant data, or long-term interoperability. The class is
implemented with R’s <code>attributes()</code> function, which
guarantees wide compatibility. A defined vector can be used even in base
R.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">attributes</span>(gdp_1)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; $label</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Gross Domestic Product&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; $class</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;haven_labelled_defined&quot; &quot;haven_labelled&quot;         &quot;vctrs_vctr&quot;            </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; [4] &quot;double&quot;                </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; $unit</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; [1] &quot;CP_MEUR&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; $concept</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;http://data.europa.eu/83i/aa/GDP&quot;</span></span></code></pre></div>
<p>From this output it is clear that the actual S3 class is called
<code>haven_labelled_defined</code>, which clearly indicates the
inheritance from <code>haven_labelled</code> (See: <a href="https://larmarange.github.io/labelled/articles/labelled.html">labelled::labelled</a>).
In the dataset summary headers the <code>&lt;defined&gt;</code>
abbreviation is used.</p>
<p>Use the <code>var_label()</code>, <code>var_unit()</code> and
<code>var_concept()</code> helper functions to set or retrieve metadata
individually.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Get the label only: &quot;</span>, <span class="fu">var_label</span>(gdp_1), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; Get the label only:  Gross Domestic Product</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Get the unit only: &quot;</span>, <span class="fu">var_unit</span>(gdp_1), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; Get the unit only:  CP_MEUR</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Get the concept definition only: &quot;</span>, <span class="fu">var_concept</span>(gdp_1), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; Get the concept definition only:  http://data.europa.eu/83i/aa/GDP</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;All attributes:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; All attributes:</span></span></code></pre></div>
</div>
<div id="printing-and-summary" class="section level2">
<h2>Printing and summary</h2>
<p>The most frequently used vector methods, such as print or summary are
implemented as expected:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">print</span>(gdp_1)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; gdp_1: Gross Domestic Product</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;  [1] 2354.8 2593.9 2883.7 3119.5 5430.5 6423.7 6758.6 1265.1 1461.4 1612.3</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">summary</span>(gdp_1)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; Gross Domestic Product (CP_MEUR)</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;    1265    1798    2739    3390    4853    6759</span></span></code></pre></div>
</div>
<div id="handling-ambiguity" class="section level2">
<h2>Handling ambiguity</h2>
<p>If you try to concatenate a semantically under-specified new vector
to an existing <code>defined</code> vector, you will get an intended
error indicating that some attributes are not compatible. This prevents
combining values that differ in meaning, such as GDP figures expressed
in different currencies.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>gdp_2 <span class="ot">&lt;-</span> <span class="fu">defined</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">2523.6</span>, <span class="fl">2725.8</span>, <span class="fl">3013.2</span>),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Gross Domestic Product&quot;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>)</span></code></pre></div>
<p>In the following example, <code>gdp_1</code> and <code>gdp_2</code>
are not defined with the same level of precision.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">c</span>(gdp_1, gdp_2)</span></code></pre></div>
<pre><code>Error in vec_c():
! Can&#39;t combine ..1 &lt;haven_labelled_defined&gt; and ..2 &lt;haven_labelled_defined&gt;.
✖ Some attributes are incompatible.</code></pre>
<p>To resolve this, you can add the missing attributes so that the
vectors are semantically compatible.</p>
<p>Let’s define better the GDP of the Faroe Islands:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">var_unit</span>(gdp_2) <span class="ot">&lt;-</span> <span class="st">&quot;CP_MEUR&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">var_concept</span>(gdp_2) <span class="ot">&lt;-</span> <span class="st">&quot;http://data.europa.eu/83i/aa/GDP&quot;</span></span></code></pre></div>
<p>Once the metadata matches, you can combine them.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>new_gdp <span class="ot">&lt;-</span> <span class="fu">c</span>(gdp_1, gdp_2)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">summary</span>(new_gdp)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; Gross Domestic Product (CP_MEUR)</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt;    1265    2355    2726    3244    3120    6759</span></span></code></pre></div>
</div>
<div id="using-namespaces-for-coded-values" class="section level2">
<h2>Using namespaces for coded values</h2>
<p>You can also define variables that store codes (like country codes)
with a namespace that points to a human- and machine-readable definition
of those codes. In statistical datasets, such attribute columns describe
characteristics of the observations or the measured variables.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>country <span class="ot">&lt;-</span> <span class="fu">defined</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;AD&quot;</span>, <span class="st">&quot;LI&quot;</span>, <span class="st">&quot;SM&quot;</span>),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Country name&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">concept =</span> <span class="st">&quot;http://purl.org/linked-data/sdmx/2009/dimension#refArea&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">namespace =</span> <span class="st">&quot;https://www.geonames.org/countries/$1/&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>)</span></code></pre></div>
<p>For example, the namespace definition above points to:</p>
<ul>
<li><a href="https://www.geonames.org/countries/AD/" class="uri">https://www.geonames.org/countries/AD/</a> in the case of
Andorra</li>
<li><a href="https://www.geonames.org/countries/LI/" class="uri">https://www.geonames.org/countries/LI/</a> for
Liechtenstein</li>
<li><a href="https://www.geonames.org/countries/SM/" class="uri">https://www.geonames.org/countries/SM/</a> for San
Marino</li>
</ul>
<p>You can get or set the namespace of a defined vector with
<code>var_namespace()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">var_namespace</span>(country)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;https://www.geonames.org/countries/$1/&quot;</span></span></code></pre></div>
<p>A URI such as <a href="http://publications.europa.eu/resource/authority/bna/c_6c2bb82d" class="uri">http://publications.europa.eu/resource/authority/bna/c_6c2bb82d</a>
resolves to a machine-readable definition of geographical names.</p>
<p>The use of several <code>defined</code> vectors in a
<code>dataset_df</code> object is explained in a separate vignette.</p>
</div>
<div id="basic-usage" class="section level2">
<h2>Basic Usage</h2>
<p>You can create <code>defined</code> vectors from character values as
well as numeric values. Methods like <code>as_character()</code> and
<code>as_numeric()</code> let you coerce back to base R types while
controlling what happens to the metadata.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">defined</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;AD&quot;</span>, <span class="st">&quot;LI&quot;</span>),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Country code&quot;</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">namespace =</span> <span class="st">&quot;https://www.geonames.org/countries/$1/&quot;</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>countries</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; x: Country code</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Defined vector </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; [1] &quot;AD&quot; &quot;LI&quot;</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="fu">as_character</span>(countries)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;AD&quot; &quot;LI&quot;</span></span></code></pre></div>
<div id="subsetting-and-coercion" class="section level3">
<h3>Subsetting and coercion</h3>
<p>Subsetting a <code>defined</code> vector works like subsetting any
other vector.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>gdp_1[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; [1] 2354.8 2593.9</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>gdp_1[gdp_1 <span class="sc">&gt;</span> <span class="dv">5000</span>]</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; [1] 5430.5 6423.7 6758.6</span></span></code></pre></div>
<ul>
<li><code>as.vector()</code> removes the metadata entirely.<br />
</li>
<li><code>as.list()</code> retains the metadata for each element
(definitions are repeated for each entry).</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">as.vector</span>(gdp_1)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#&gt;  [1] 2354.8 2593.9 2883.7 3119.5 5430.5 6423.7 6758.6 1265.1 1461.4 1612.3</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">as.list</span>(gdp_1)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; [1] 2354.8</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; [1] 2593.9</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; [1] 2883.7</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; [1] 3119.5</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; [[5]]</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; [1] 5430.5</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; [[6]]</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt; [1] 6423.7</span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt; [[7]]</span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt; [1] 6758.6</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt; [[8]]</span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt; [1] 1265.1</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a><span class="co">#&gt; [[9]]</span></span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a><span class="co">#&gt; [1] 1461.4</span></span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a><span class="co">#&gt; [[10]]</span></span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a><span class="co">#&gt; x: Gross Domestic Product</span></span>
<span id="cb17-51"><a href="#cb17-51" tabindex="-1"></a><span class="co">#&gt; Defined as http://data.europa.eu/83i/aa/GDP, measured in CP_MEUR </span></span>
<span id="cb17-52"><a href="#cb17-52" tabindex="-1"></a><span class="co">#&gt; [1] 1612.3</span></span></code></pre></div>
</div>
<div id="coerce-to-base-r-types" class="section level3">
<h3>Coerce to base R types</h3>
<p><code>defined()</code> vectors support a family of coercion
helpers.<br />
These methods avoid silent metadata loss and provide predictable
conversions while respecting the underlying data type.</p>
<p>All coercion functions follow the same principles:</p>
<ul>
<li><strong>They operate on the underlying values</strong>, not on
labels.<br />
</li>
<li><strong>Metadata is removed by default</strong> unless explicitly
preserved.<br />
</li>
<li><strong>Errors are thrown when coercion would lose
information</strong> (e.g., converting character data to numeric).</li>
</ul>
<p>Below are the available coercion helpers.</p>
<div id="character-coercion" class="section level4">
<h4>Character coercion</h4>
<p><code>as_character()</code> converts the vector to a base R character
vector.</p>
<p>If value labels are present, they become the character
representation; otherwise, the underlying values are coerced.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">as_character</span>(country)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;AD&quot; &quot;LI&quot; &quot;SM&quot;</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">as_character</span>(<span class="fu">c</span>(gdp_1, gdp_2))</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;2354.8&quot; &quot;2593.9&quot; &quot;2883.7&quot; &quot;3119.5&quot; &quot;5430.5&quot; &quot;6423.7&quot; &quot;6758.6&quot; &quot;1265.1&quot;</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;1461.4&quot; &quot;1612.3&quot; &quot;2523.6&quot; &quot;2725.8&quot; &quot;3013.2&quot;</span></span></code></pre></div>
</div>
<div id="factor-coercion" class="section level4">
<h4>Factor coercion</h4>
<p><code>as_factor()</code> converts the vector into a factor.</p>
<ul>
<li>If value labels exist, they become factor levels.</li>
<li>If not, the underlying values determine the factor levels.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">as_factor</span>(country)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#&gt; [1] AD LI SM</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt; Levels: AD LI SM</span></span></code></pre></div>
</div>
<div id="numeric-coercion" class="section level4">
<h4>Numeric coercion</h4>
<p><code>as_numeric()</code> converts numeric <code>defined</code>
vectors to base R numeric.</p>
<p>It throws an error if the underlying data is not numeric.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">as_numeric</span>(<span class="fu">c</span>(gdp_1, gdp_2))</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#&gt;  [1] 2354.8 2593.9 2883.7 3119.5 5430.5 6423.7 6758.6 1265.1 1461.4 1612.3</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; [11] 2523.6 2725.8 3013.2</span></span></code></pre></div>
</div>
<div id="logical-coercion" class="section level4">
<h4>Logical coercion</h4>
<p><code>as_logical()</code> converts <code>defined</code> vectors whose
underlying data is logical (<code>TRUE</code>/<code>FALSE</code>).</p>
<p>Logical <code>defined</code> vectors cannot have value labels,
ensuring consistent behaviour.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>flag <span class="ot">&lt;-</span> <span class="fu">defined</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="at">label =</span> <span class="st">&quot;Example flag&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">as_logical</span>(flag)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt; [1]  TRUE FALSE  TRUE</span></span></code></pre></div>
</div>
<div id="date-coercion" class="section level4">
<h4>Date coercion</h4>
<p><code>as_Date()</code> converts a <code>defined</code> vector that
inherits from <code>Date</code> back into a standard R <code>Date</code>
vector.</p>
<p>Metadata is removed unless requested.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">defined</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2020-01-01&quot;</span>, <span class="st">&quot;2020-01-02&quot;</span>)),</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Reference date&quot;</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">as.Date</span>(dates)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2020-01-01&quot; &quot;2020-01-02&quot;</span></span></code></pre></div>
</div>
<div id="posixct-coercion" class="section level4">
<h4>POSIXct coercion</h4>
<p><code>as_POSIXct()</code> converts a POSIXct-based
<code>defined</code> vector back into a base R <code>POSIXct</code>
object.</p>
<p>Time zones and the underlying numeric representation are always
preserved.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">defined</span>(</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">&quot;2020-01-01 12:00:00&quot;</span>, <span class="st">&quot;2020-01-01 18:00:00&quot;</span>)),</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Timestamp&quot;</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>times </span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; x: Timestamp</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; Defined vector </span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; [1] 1577876400 1577898000</span></span></code></pre></div>
<p>These coercion helpers ensure that <code>defined</code> vectors
behave predictably in modelling, exporting, and data cleaning workflows
— while still preserving semantic metadata when necessary.</p>
</div>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>The <code>defined()</code> function provides a lightweight yet
powerful way to make vectors self-descriptive by attaching semantic
metadata directly to them. By combining a variable label, unit of
measurement, concept definition, and optional namespace,
<code>defined</code> ensures that each vector’s meaning is explicit,
consistent, and machine-readable.</p>
<p>Because the metadata is embedded at creation time, it travels with
the vector throughout your workflow — whether you are analysing,
transforming, or exporting data.<br />
This prevents context loss, supports the FAIR data principles (Findable,
Accessible, Interoperable, Reusable), and facilitates integration with
semantic web technologies.</p>
<p><code>defined</code> vectors work seamlessly with the <a href="https://dataset.dataobservatory.eu/articles/dataset_df.html"><code>dataset_df</code></a>
class to create semantically enriched data frames where both datasets
and their constituent variables carry rich, standardised metadata.<br />
For more on creating semantically enriched datasets, see the
<strong>dataset_df</strong> vignette.</p>
<p>For guidance on recording bibliographic metadata and citations, see
the <strong>bibrecord</strong> vignette.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
