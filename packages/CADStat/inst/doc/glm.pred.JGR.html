<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
  <!-- This file was converted to xhtml by Writer2xhtml ver. 0.5. See http://www.hj-gym.dk/~hj/writer2latex for more info. -->
  <head profile="http://dublincore.org/documents/dcq-html/">
    <title>Regression Prediction</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC" />
    <meta content="Regression Prediction" name="DC.title" />
    <meta content="" name="DC.subject" />
    <meta content="" name="DC.description" />
    <meta content="" name="DC.creator" />
    <meta content="2008-07-02T16:13:23" name="DC.date" />
    <meta content="en-US" name="DC.language" />
    <link href="styles/caddis.css" media="all" rel="stylesheet" type="text/css" />
  </head>
  <body dir="ltr">
    <div id="TOC7Cregion">
      <div id="TableofContents1">
        <p class="ContentsHeading">Table of Contents</p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc0">Introduction</a>
        </p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc1">Tool Use</a>
        </p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc2">Example</a>
        </p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc3">Technical Details</a>
        </p>
      </div>
      <p class="Standard"></p>
    </div>
    <div id="MainContent7Cregion">
      <p class="Title">CADStat: Statistical Tools for Causal Analysis</p>
      <p class="Title">Regression Prediction</p>
      <h1 id="toc0"><span class="SectionNumber"></span>Introduction</h1>
      <p>The regression prediction tool provides a way to model natural variations in an environmental parameter (e.g., stream temperature) in reference (i.e., least-disturbed) sites.  Then, one can use the reference site model to determine whether observations of that same parameter in test sites are within the range of variation defined by the reference sites.  </p>
      <p>The linear regression tool has more options available for diagnosing and assessing the fit of a regression model on the quality data.  The regression prediction tool assumes that such diagnostics have been performed to define a regression model, and the goal is now to apply the model to new data.</p>
      <h1 id="toc1"><span class="SectionNumber"></span>Tool Use</h1>
      <p>Select <i>Analysis Tools -&gt; Regression Prediction</i> from the menus.  A dialog box will open.  Select the data set of interest from the pull-down menu, or browse for a tab-delimited text file.  The Data Subsetting tab can be used to select a subset of the data file by choosing a variable from the pull down menu and then selecting the levels of that variable to include.  You can hold down the &lt;CTRL&gt; key to add several levels. </p>
      <p>Select <b>Dependent </b>variable and <b>Independent</b> variables as in the linear regression tool.</p>
      <p>By default, an intercept is included in the model.  The intercept can be excluded by selecting <b>Remove Intercept</b> under the Analysis Options<i>, </i>in which case at least one independent variable must have been selected.</p>
      <p>Select a <b>Reference Variable</b> &mdash; a variable that contains (character) values which can be used to identify which rows correspond to reference data.  Once the Reference Variable is selected, select the levels of that variable that correspond to reference data.  You can hold down the &lt;CTRL&gt; key to select multiple levels that indicate reference.</p>
      <p>Choose a <b>Significance Level</b> for identification of anomalous data points in the new data.  Note that the significance level corresponds to a level for a single prediction, not a family-wise significance level; no correction is performed for multiple comparisons when multiple predictions are being made.  Keep in mind that some new data is expected to be flagged as significant (on average, about the number of predictions times the significance level should appear significant, depending on correlation). </p>
      <p>The <b>ID Variable</b> allows for a label variable to be specified, so that points that differ significantly from reference can be identified on the plot.  If no ID Variable is selected, then the row number will be used instead.</p>
      <p>The output of the regression prediction tool is a table for the test (non-reference) data, including the observed and predicted values, the standard error associated with the prediction,<i> </i>a <i>p</i>-value for the prediction, an indication of whether the sample differs significantly from reference, an indication of whether the independent variables for the new data are in range of the model fit, and finally an indication of whether or not the normal approximation used to calculate the p-value is appropriate [for poisson and binomial regression only].  Note: for binomial data, the observed value is converted from a count to a proportion (dependent variable divided by sample size).  A plot of observed versus predicted values is also produced, to help assess the model fit and identify anomalous data points.</p>
      <h1 id="toc2"><span class="SectionNumber"></span>Example</h1>
      <p>For this example, select <i>Analysis Tools -&gt; Regression Prediction</i>.</p>
      <p></p>
      <div style="text-align:center">
        <img alt="Screenshot of JGR console. Regression Prediction, a sub-menu of the Analysis Tools tab, has been selected." class="frameGraphics" id="graphics27Cgraphics" src="../img/glm.pred.JGR-img1.png" style="width:480.0px;height:192.0px" />
      </div>
      <p></p>
      <p>Select <tt>mergedData</tt> as the active dataset (see help page for <b>Loading and merging data</b> for information on loading CADStat example data).  </p>
      <p></p>
      <div style="text-align:center">
        <img alt="Screenshot of the Regression Prediction dialog page. mergedData.txt, a data set generated in the data loading and merging help page, has been chosen as the Active dataset. Under the Varibles tab, the dependent variable has been set to 'temp.avg', whereas 'lat', 'area, and 'elev.ut' have been selected as independent variables. Under Reference Selection, the Reference Variable has been set to 'REF', and in the Reference Data Values box, 'REF' has been selected. The Variable for Labels under ID Variable has been set to 'STRM.ID'. Significance Level, under Analysis Options, has been set to '0.05'." class="frameGraphics" id="graphics17Cgraphics" src="../img/glm.pred.JGR-img2.png" style="width:593.99036px;height:588.9984px" />
      </div>
      <p></p>
      <p>Select the normal distribution for standard linear regression, then select <tt>temp.avg</tt> as the dependent variable, and both <tt>lat</tt> (latitude), <tt>area </tt>(log catchment area), and <tt>elev.ut</tt> (elevation) for the independent variables.  [Reminder: holding down the &lt;CTRL&gt; key while clicking allows you to select multiple independent variables.  Make sure that both appear in the formula at the bottom left of the screen.]  Choose REF as the reference variable, then select&ldquo;Ref&rdquo; as the level that indicates a reference data point.  Finally, select STRM.ID as the ID Variable.</p>
      <p></p>
      <p>The output table gives several pieces of information for each new (non-reference) data point.  The p-value column gives an estimate of the probability that the observation at the test site was drawn from the same population as the reference sites.  A low p-value suggests that the test site conditions are likely different from reference expectations.  The final column, labeled&ldquo;In Range?&rdquo;, gives an indication of whether one should expect the model to perform well for that data point, given the values of the independent variables.</p>
      <div style="text-align:center">
        <img alt="Plot of 'Predicted vs. Observed' values generated by Regression Prediction dialog page." class="frameGraphics" id="graphics47Cgraphics" src="../img/glm.pred.JGR-img4.png" style="width:492.01917px;height:484.992px" />
      </div>
      <p> </p>
      <p>The plot helps summarize the output table.  The black dots give the predicted and observed values for the reference data.  The new data is then indicated by other colors and symbols, depending on whether or not the data point was a significant deviation from the model, as well as whether or not the model was expected to predict the point well.  For plotting purposes, any data point considered out of range or borderline is denoted as out of range of the model.  In this example, four streams had observed temperature significantly higher than predicted by the reference model.  That is, temperature was higher than expected if these streams were in reference condition.</p>
      <h1 id="toc3"><span class="SectionNumber"></span>Technical Details</h1>
      <ul>
        <li>
          <p>Statistical significance is based on a t-statistic when standard (normal) linear regression is used, or on an approximate z-statistic when Poisson or binomial (logistic) regression is used.  The statistic is of the form:</p>
            <p><img alt="Mathematical Equation describing Statistical significance. Observed minus predicted divided by the Standard Error." src="../img/math/stat-sig.gif"</p>
            <!-- Keeping old MathML, in case it need to be re-rendered.-->
              <!--<p> <math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mtext>Observed</mtext><mo stretchy="false">−</mo><mtext>Predicted</mtext></mrow><mtext>    Standard Error</mtext></mfrac></math> .</p>-->
          <p>The standard error combines the uncertainty associated with the regression fit and the inherent uncertainty in a new data point.  These two variances are added to produce the standard error, which provides an exact standard error for standard linear regression with degrees of freedom equal to the number of data points in the reference dataset minus the number of regression coefficients.  </p>
        </li>
        <li>
          <p>For Poisson and binomial regression, the combined standard error is only an approximation for the standard error.  The p-value calculated, based on the z-statistic in this case is generally considered valid only for certain values of the predicted mean, that allow for sufficient variability in the result for the discrete variables to approximate the continuous, normal random variable.  For purposes here, the normal approximation is considered reasonable for the Poisson if the predicted value is higher than 5.  For the binomial, the predicted number of successes must be higher than 5 <i>and</i> the predicted number of successes must be lower than the sample size minus 5.</p>
        </li>
        <li>
          <p>It is important to assess whether or not a new data point is &ldquo;in range&rdquo; of the independent variables of the reference data.  If the independent variables are outside the range of the reference data, then the predicted values from the model are <i>extrapolations</i>, meaning that the linearity assumptions of the regression model have no basis in data.  The predictions may still be viable, but they should be treated with caution.  </p>
          <p>For purposes of this tool, the statistic used for assessing whether a data point is &ldquo;in range&rdquo; is:</p>
            <!-- Keeping old mathml in case it needs to be re-rendered. -->
          <!--<p> <math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>x</mi><msub><mi>'</mi><mtext>new</mtext></msub><msup><mfenced close=")" open="("><mrow><mi>X</mi><mi>'</mi><mi>X</mi></mrow></mfenced><mrow><mo stretchy="false">−</mo><mn>1</mn></mrow></msup><msub><mi>x</mi><mtext>new</mtext></msub></mrow><mrow><mi>k</mi><mo stretchy="false">/</mo><mi>n</mi></mrow></mfrac></math> ,</p>-->
            <p><img alt="Statistic for determining whether a data point is in range. Lowercase x prime new times uppercase X prime times X to the negative first power times x new divided by k over n." src="../img/math/stat.in.range.gif"></p>
          <p>where <i> X<!--<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math>--> </i> is the matrix of independent variables for the reference data, <i> x<sub>new</sub> <!--<math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow><mi>&ldquo;</mi><mi fontstyle="italic">new</mi><mi>&rdquo;</mi></mrow></msub></math>--></i>  is the vector of independent variables for the new data point, ' represents matrix transpose, <i> k <!-- <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math>--> </i> is the number of coefficients in the regression model, and <i>n</i> <!--<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math>-->  is the number of data points in the reference dataset.  (See e.g. John O. Rawlings' <i>Applied Regression Analysis</i> for a discussion of this statistic.)  The data point is considered &ldquo;borderline&rdquo; if this statistic is greater than 2, and &ldquo;out of range&rdquo; if this statistic is greater than 5.</p>
          <p></p>
        </li>
      </ul>
      <p></p>
      <p> </p>
    </div>
  </body>
</html>
