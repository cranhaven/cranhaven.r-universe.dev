<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>How to start</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">How to start</h1>



<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p>The basic idea of this vignette is to illustrate to users how to use
the flexFitR package. We’ll start with a very basic example: a simple
linear regression. Although this example is not the primary focus of the
package, it will serve to demonstrate its use.</p>
</div>
<div id="simple-linear-regression" class="section level2">
<h2>1. Simple linear regression</h2>
<p>In this example, we’ll work with a small dataset consisting of 6
observations, where X is the independent variable and Y is the dependent
variable.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(flexFitR)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">Y =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">44</span>, <span class="dv">50</span>, <span class="dv">95</span>, <span class="dv">100</span>))</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">explorer</span>(dt, X, Y), <span class="at">type =</span> <span class="st">&quot;xy&quot;</span>)</span></code></pre></div>
<p><img role="img" aria-label="Plot x,y" src="data:image/png;base64,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" alt="Plot x,y" /></p>
<p>First, we define an objective function. In this case, the function
<code>fn_lm</code> will represent the linear regression, where b is the
intercept and m is the slope of the regression.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>fn_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, b, m) {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  y <span class="ot">&lt;-</span> b <span class="sc">+</span> m <span class="sc">*</span> x</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>plot_fn</code> function, which is integrated into the
package, allows us to plot any function with the parameters provided.
This is useful for visualizing the shape of the function before fitting
the model to the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot_fn</span>(<span class="at">fn =</span> <span class="st">&quot;fn_lm&quot;</span>, <span class="at">params =</span> <span class="fu">c</span>(<span class="at">b =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img role="img" aria-label="Plot function" src="data:image/png;base64,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" alt="Plot function" /></p>
<p>To fit the model, we use the <code>modeler</code> function. In this
function, we pass x as the independent variable, y as the dependent
variable, and then a vector of parameters where we assign initial values
to our coefficient b and coefficient m.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> dt <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">modeler</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">x =</span> X,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">y =</span> Y,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">fn =</span> <span class="st">&quot;fn_lm&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">parameters =</span> <span class="fu">c</span>(<span class="at">b =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">m =</span> <span class="dv">10</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  )</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>mod</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; Y ~ fn_lm(X, b, m) </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; -1.18875 -0.57369 -0.03282  0.00000  0.58494  1.21753 </span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt;  uid     b    m sse</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt;    1 -15.5 19.5 449</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; Metrics:</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt;  Groups     Timing Convergence Iterations</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt;       1 0.053 secs        100%   354 (id)</span></span></code></pre></div>
<p>Once the model is fitted, we can examine the output, extract the
estimated parameters, make some plots, and predict new x values.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">plot</span>(mod, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Raw data&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">plot</span>(mod, <span class="at">type =</span> <span class="dv">4</span>, <span class="at">n_points =</span> <span class="dv">200</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">ggarrange</span>(a, b)</span></code></pre></div>
<p><img role="img" aria-label="Plot evolution" src="data:image/png;base64,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" alt="Plot evolution" /></p>
<p>In order to get the coefficients with their variance-covariance
matrix we make use of the <code>coef</code> and <code>vcov</code>
function, which only takes the model object as an argument.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">coef</span>(mod)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 1     1 fn_lm   b              -15.5      9.86     -1.57    0.192  </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 2     1 fn_lm   m               19.5      2.53      7.71    0.00152</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">vcov</span>(mod)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; $`1`</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;           b          m</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; b  97.21937 -22.435238</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; m -22.43524   6.410068</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;fn_name&quot;)</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fn_lm&quot;</span></span></code></pre></div>
<p>Finally, we can make predictions using the predict function, which
takes the fitted model as an object and X as the value for which we want
to make the prediction.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">x =</span> <span class="fl">4.5</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;     uid fn_name x_new predicted.value std.error</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 1     1 fn_lm     4.5            72.3      5.01</span></span></code></pre></div>
<p>We can compare this with the lm function in R, which will give
results similar to those obtained with our package.</p>
<div id="comparison-with-lm" class="section level3">
<h3>Comparison with <code>lm</code></h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>mo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> dt)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">summary</span>(mo)<span class="sc">$</span>coefficients</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error   t value    Pr(&gt;|t|)</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; (Intercept) -15.46667   9.859988 -1.568629 0.191812151</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; X            19.51429   2.531811  7.707639 0.001524882</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">vcov</span>(mo)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt;             (Intercept)          X</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; (Intercept)    97.21937 -22.435238</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; X             -22.43524   6.410068</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">predict</span>(mo, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">X =</span> <span class="fl">4.5</span>), <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; $fit</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;        1 </span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; 72.34762 </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; $se.fit</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; [1] 5.010599</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; $df</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; $residual.scale</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; [1] 10.59133</span></span></code></pre></div>
<p>While the previous example was fairly simple, we can consider a more
complex scenario where we need to fit not just one function, but
hundreds of functions for several groups. This can be achieved using the
<code>grp</code> argument in the <code>modeler</code> function.
Additionally, we can parallelize these processes by setting the
<code>parallel</code> argument to <code>TRUE</code> and defining the
number of cores to use.</p>
<p>It’s important to note that depending on the functions defined by the
user, some parameters may need to be constrained, such as being required
to be greater than or less than zero. In other cases, certain parameters
might need to be fixed at known values. In these more complex
situations, where we have many curves to fit and are working with
complex functions—whether non linear regressions with specific parameter
constraints or cases where some parameters are fixed for each
group—modeler offers extensive flexibility.</p>
</div>
</div>
<div id="piece-wise-regression" class="section level2">
<h2>2. Piece-wise regression</h2>
<p>The following example, although still simple, represents a slightly
more complex function with a greater number of parameters. In this case,
we have a piece-wise regression, parameterized by <code>t1</code>,
<code>t2</code>, and <code>k</code>, and defined by the following
expression:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t, <span class="at">t1 =</span> <span class="dv">45</span>, <span class="at">t2 =</span> <span class="dv">80</span>, <span class="at">k =</span> <span class="fl">0.9</span>) {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="at">test =</span> t <span class="sc">&lt;</span> t1,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="at">yes =</span> <span class="dv">0</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="at">no =</span> <span class="fu">ifelse</span>(</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>      <span class="at">test =</span> t <span class="sc">&gt;=</span> t1 <span class="sc">&amp;</span> t <span class="sc">&lt;=</span> t2,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>      <span class="at">yes =</span> k <span class="sc">/</span> (t2 <span class="sc">-</span> t1) <span class="sc">*</span> (t <span class="sc">-</span> t1),</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>      <span class="at">no =</span> k</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    )</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  )</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Before fitting the model, let’s take a look at the example
dataset.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">29</span>, <span class="dv">36</span>, <span class="dv">42</span>, <span class="dv">56</span>, <span class="dv">76</span>, <span class="dv">92</span>, <span class="dv">100</span>, <span class="dv">108</span>),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.67</span>, <span class="fl">15.11</span>, <span class="fl">77.38</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">explorer</span>(dt, time, variable), <span class="at">type =</span> <span class="st">&quot;xy&quot;</span>)</span></code></pre></div>
<p><img role="img" aria-label="Plot x,y" src="data:image/png;base64,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" alt="Plot x,y" /></p>
<p>We can make a plot of the piecewise function and then fit the model
using the <code>modeler</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot_fn</span>(<span class="at">fn =</span> <span class="st">&quot;fun&quot;</span>, <span class="at">params =</span> <span class="fu">c</span>(<span class="at">t1 =</span> <span class="dv">25</span>, <span class="at">t2 =</span> <span class="dv">70</span>, <span class="at">k =</span> <span class="dv">90</span>))</span></code></pre></div>
<p><img role="img" aria-label="Plot function" src="data:image/png;base64,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" alt="Plot function" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>mod_1 <span class="ot">&lt;-</span> dt <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">modeler</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    <span class="at">x =</span> time,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    <span class="at">y =</span> variable,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    <span class="at">fn =</span> <span class="st">&quot;fun&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>    <span class="at">parameters =</span> <span class="fu">c</span>(<span class="at">t1 =</span> <span class="dv">40</span>, <span class="at">t2 =</span> <span class="dv">70</span>, <span class="at">k =</span> <span class="dv">100</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  )</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>mod_1</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; variable ~ fun(time, t1, t2, k) </span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt;  0.0000  0.0000  0.0000  0.2722  0.0000  2.4495 </span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;  uid   t1 t2    k   sse</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt;    1 38.6 61 99.8 0.449</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; Metrics:</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt;  Groups      Timing Convergence Iterations</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt;       1 0.0715 secs        100%   473 (id)</span></span></code></pre></div>
<p>After fitting the model, we can examine the results, plot the fitted
curve, extract the coefficients and their associated p-values, obtain
the variance-covariance matrix, and make predictions for unknown values
of x.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot</span>(mod_1)</span></code></pre></div>
<p><img role="img" aria-label="Plot evolution" src="data:image/png;base64,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" alt="Plot evolution" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">coef</span>(mod_1)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 7</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; 1     1 fun     t1              38.6    0.0779      496.   4.54e-15</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; 2     1 fun     t2              61.0    0.0918      665.   7.82e-16</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; 3     1 fun     k               99.8    0.137       730.   4.47e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Variance-Covariance Matrix</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">vcov</span>(mod_1)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt; $`1`</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt;               t1           t2            k</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; t1  6.061705e-03 -0.002940001 1.877076e-07</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; t2 -2.940001e-03  0.008431400 4.204939e-03</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt; k   1.877076e-07  0.004204939 1.870426e-02</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;fn_name&quot;)</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fun&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Making predictions</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">predict</span>(mod_1, <span class="at">x =</span> <span class="dv">45</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt;     uid fn_name x_new predicted.value std.error</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; 1     1 fun        45            28.5     0.223</span></span></code></pre></div>
<div id="comparison-with-nls" class="section level3">
<h3>Comparison with <code>nls</code></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>mod_nls <span class="ot">&lt;-</span> dt <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">nls</span>(</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>    <span class="at">formula =</span> variable <span class="sc">~</span> <span class="fu">fun</span>(time, t1, t2, k),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">c</span>(<span class="at">t1 =</span> <span class="dv">40</span>, <span class="at">t2 =</span> <span class="dv">70</span>, <span class="at">k =</span> <span class="dv">100</span>),</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>    <span class="at">algorithm =</span> <span class="st">&quot;default&quot;</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  )</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="fu">summary</span>(mod_nls)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; Formula: variable ~ fun(time, t1, t2, k)</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; t1 38.60286    0.07786   495.8 4.54e-15 ***</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt; t2 61.04288    0.09183   664.7 7.82e-16 ***</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; k  99.81000    0.13676   729.8 4.47e-16 ***</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.2735 on 6 degrees of freedom</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 4 </span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 3.927e-06</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="fu">coef</span>(mod_nls)</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt;       t1       t2        k </span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt; 38.60286 61.04288 99.81000</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="fu">vcov</span>(mod_nls)</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co">#&gt;               t1           t2             k</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="co">#&gt; t1  6.062452e-03 -0.002940973 -6.025873e-13</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#&gt; t2 -2.940973e-03  0.008433026  4.205209e-03</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co">#&gt; k  -6.025873e-13  0.004205209  1.870417e-02</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="fu">predict</span>(mod_nls, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="dv">45</span>))</span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="co">#&gt; [1] 28.45357</span></span></code></pre></div>
<p>As we can see, we get very similar results when compared to
<code>nls</code>.</p>
<p>Finally, we will illustrate how to provide different initial values
to the function when dealing with multiple groups, and we will also show
how to fix some parameters of the objective function.</p>
</div>
<div id="providing-initial-values" class="section level3">
<h3>Providing Initial values</h3>
<p>In this example, we don’t have a grouping variable. However, by
default, the function assigns a unique identifier (<code>uid</code>) to
the dataset. Because of this, we need to specify <code>uid = 1</code>
for the initial values and fixed parameters. If there is only one group,
you only need to modify the parameters argument accordingly. This
approach is primarily for illustrative purposes.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>init <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">uid =</span> <span class="dv">1</span>, <span class="at">t1 =</span> <span class="dv">20</span>, <span class="at">t2 =</span> <span class="dv">30</span>, <span class="at">k =</span> <span class="fl">0.8</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>mod_2 <span class="ot">&lt;-</span> dt <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="fu">modeler</span>(</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>    <span class="at">x =</span> time,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>    <span class="at">y =</span> variable,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    <span class="at">fn =</span> <span class="st">&quot;fun&quot;</span>,</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    <span class="at">parameters =</span> init</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  )</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>mod_2</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt; variable ~ fun(time, t1, t2, k) </span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt;  0.0000  0.0000  0.0000  0.2722  0.0000  2.4495 </span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt;  uid   t1 t2    k   sse</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt;    1 38.6 61 99.8 0.449</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt; Metrics:</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt;  Groups      Timing Convergence Iterations</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt;       1 0.0938 secs        100%   567 (id)</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a><span class="fu">coef</span>(mod_2)</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 7</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt; 1     1 fun     t1              38.6    0.0779      496.   4.54e-15</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt; 2     1 fun     t2              61.0    0.0918      665.   7.82e-16</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; 3     1 fun     k               99.8    0.137       730.   4.47e-16</span></span></code></pre></div>
</div>
<div id="fixing-parameters" class="section level3">
<h3>Fixing parameters</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>fix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">uid =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">98</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>mod_3 <span class="ot">&lt;-</span> dt <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">modeler</span>(</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>    <span class="at">x =</span> time,</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>    <span class="at">y =</span> variable,</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>    <span class="at">fn =</span> <span class="st">&quot;fun&quot;</span>,</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>    <span class="at">parameters =</span> <span class="fu">c</span>(<span class="at">t1 =</span> <span class="dv">40</span>, <span class="at">t2 =</span> <span class="dv">70</span>, <span class="at">k =</span> <span class="dv">100</span>),</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>    <span class="at">fixed_params =</span> fix</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  )</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>mod_3</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; variable ~ fun(time, t1, t2, k) </span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt;  0.0000  0.0000  0.4815  0.6316  1.3008  1.3008 </span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt;  uid   t1   t2  sse  k</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt;    1 38.6 60.6 13.6 98</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; Metrics:</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt;  Groups      Timing Convergence Iterations</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt;       1 0.0567 secs        100%   313 (id)</span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="fu">coef</span>(mod_3)</span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a><span class="co">#&gt; 1     1 fun     t1              38.6     0.396      97.5   3.15e-12</span></span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a><span class="co">#&gt; 2     1 fun     t2              60.6     0.429     141.    2.34e-13</span></span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a><span class="fu">plot</span>(mod_3)</span></code></pre></div>
<p><img role="img" aria-label="Plot evolution" src="data:image/png;base64,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" alt="Plot evolution" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">performance</span>(mod_1, mod_2, mod_3)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#&gt;   fn_name uid df nobs p logLik   AIC  AICc   BIC Sigma   SSE  MAE  MSE RMSE R2</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; 1   fun_1   1  4    9 3   0.72  6.56 16.56  7.35  0.27  0.45 0.07 0.05 0.22  1</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt; 2   fun_2   1  4    9 3   0.72  6.56 16.56  7.35  0.27  0.45 0.07 0.05 0.22  1</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#&gt; 3   fun_3   1  3    9 2 -14.61 35.23 40.03 35.82  1.39 13.55 0.88 1.51 1.23  1</span></span></code></pre></div>
<p>This vignette provided a basic introduction to using the flexFitR
package, starting with simple examples such as linear regression and
piecewise regression. The goal was to demonstrate the fundamental
features and flexibility of the package. However, more complex
situations can arise when working with high-throughput phenotypic (HTP)
data, which involve multiple groups, parameter constraints, and advanced
modeling scenarios. These more complex situations are illustrated in the
other vignettes, which use real HTP data to showcase the full
capabilities of the flexFitR package.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
